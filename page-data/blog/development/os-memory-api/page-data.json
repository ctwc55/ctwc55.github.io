{"componentChunkName":"component---src-templates-article-jsx","path":"/blog/development/os-memory-api","result":{"data":{"datoCmsMiscTextString":{"locale":"ko-KR","updatedAtText":"업데이트됨","nextReadText":"관련있는 게시물"},"datoCmsBlogPost":{"locale":"ko-KR","originalId":"145790692","title":"[운영체제][OSTEP] 메모리 관리 API","seo":{"seoTitle":"[운영체제][OSTEP] 메모리 관리 API","seoDescription":"Unix/C 프로그램에서 메모리를 할당하고 관리하는 방법에 대해 공부해봅니다.","seoImage":{"seoImageUrl":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format"}},"subtitle":"Unix/C 프로그램에서 메모리를 할당하고 관리하는 방법에 대해 공부해봅니다.","coverImage":{"coverImageData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&w=860","srcSet":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.25&w=860 215w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.5&w=860 430w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&w=860 860w","sizes":"(min-width: 860px) 860px, 100vw"}},"layout":"constrained","placeholder":{"fallback":"data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHBwgHBgoICAgLCgoLDhMVDhcNDh0VDxUSGhYdHSIVFhUaKysjGh0oHSEWJDUlKC0vMjIyGSI4PTcwPCsxMi8BCgsLCgUFEBAOEC8oIhwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL//AABEIAAwAGAMBIgACEQEDEQH/xAAYAAEAAwEAAAAAAAAAAAAAAAAFAQQGAP/EAB0QAAEEAgMAAAAAAAAAAAAAAAEAAgMEESEFEjL/xAAWAQADAAAAAAAAAAAAAAAAAAAAAQP/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDD1KM1uPLjpIRUI4GZc4aRXH25hTOHqqbth7yDIVIiXI2IQzqCoREhL/RyuQH/2Q=="},"width":860,"height":430}},"meta":{"updatedAt":"2023-07-15T15:20:04.667+09:00","firstPublishedAt":"2023-07-04T01:03:46.625+09:00"},"categoryLink":{"title":"개발 공부","id":"4743072"},"author":{"authorName":"손승열(Son Seungyeol)","picture":{"authorPictureData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.78&w=77","srcSet":"https://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.2&w=77 15w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.39&w=77 30w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.78&w=77 60w","sizes":"(min-width: 60px) 60px, 100vw"}},"layout":"constrained","placeholder":{"fallback":"data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHBwgHBgoICAgWEQ8LDhgYDhUNDhgNDw8NFxUdGBYfFhUaHysjGikoHRUWJDUlKC0vMjIyGSI4PTcwPCsxMi8BCgsLDg0OHBANHDUcIig7NS81NS81MjUvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL//AABEIABgAFAMBIgACEQEDEQH/xAAYAAEAAwEAAAAAAAAAAAAAAAAABQYHAv/EAB4QAAICAgMBAQAAAAAAAAAAAAABAgMFBgQRQXEi/8QAFQEBAQAAAAAAAAAAAAAAAAAABAP/xAAaEQACAwEBAAAAAAAAAAAAAAAAAQIDEhMR/9oADAMBAAIRAxEAPwDT8/1LHSK/r67scevSfz99VXBkm/Cva/zKle/pCc/JoRXWsFujxvygcLI1pAXqQTmjONm2RzpceyCwmwxpsbbADWJdBFbeCfe2wXoAGpIL6z//2Q=="},"width":60,"height":60}}},"relatedPosts":[{"id":"145795748","meta":{"updatedAt":"2023-07-04T21:27:03.130+09:00"},"categoryLink":{"title":"개발 공부"},"coverImage":{"gatsbyImageData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.35&w=860","srcSet":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.09&w=860 75w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.18&w=860 150w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.35&w=860 300w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.7&w=860 600w","sizes":"(min-width: 300px) 300px, 100vw"}},"layout":"constrained","width":300,"height":120},"squaredImage":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.24&fit=crop&fp-x=0.5&fp-y=0.5&w=430","srcSet":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.06&fit=crop&fp-x=0.5&fp-y=0.5&w=430 25w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.12&fit=crop&fp-x=0.5&fp-y=0.5&w=430 50w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.24&fit=crop&fp-x=0.5&fp-y=0.5&w=430 100w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.47&fit=crop&fp-x=0.5&fp-y=0.5&w=430 200w","sizes":"(min-width: 100px) 100px, 100vw"}},"layout":"constrained","placeholder":{"fallback":"data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHBwgHBhINEBAQCggUDg0IDgcHFh0JFhEYFxUZGCIVFhUaHysjGh0oHRUWJDUlKC0vMjIyGSI4PTcwPCsxMi8BCgsLDg0OEg4REC8dFhwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL//AABEIABgAGAMBIgACEQEDEQH/xAAaAAEBAAIDAAAAAAAAAAAAAAAABAUGAQID/8QAHRAAAgICAwEAAAAAAAAAAAAAAAIDBAEREhQVBf/EABYBAQEBAAAAAAAAAAAAAAAAAAADAf/EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/ANASs2WLoaraMl1o0O241wSYlSHjgHM9hVAEFr6bKSemzAAeclpnAAH/2Q=="},"width":100,"height":100}},"author":{"authorName":"손승열(Son Seungyeol)","picture":{"authorImageData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.39&w=77","srcSet":"https://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.11&w=77 8w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.2&w=77 15w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.39&w=77 30w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.78&w=77 60w","sizes":"(min-width: 30px) 30px, 100vw"}},"layout":"constrained","width":30,"height":30}}},"subtitle":"주소 공간의 개념에 대해 공부해봅니다.","title":"[운영체제][OSTEP] 주소 공간의 개념"},{"id":"176854321","meta":{"updatedAt":"2023-07-18T17:02:12.468+09:00"},"categoryLink":{"title":"개발 공부"},"coverImage":{"gatsbyImageData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.35&w=860","srcSet":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.09&w=860 75w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.18&w=860 150w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.35&w=860 300w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.7&w=860 600w","sizes":"(min-width: 300px) 300px, 100vw"}},"layout":"constrained","width":300,"height":120},"squaredImage":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.24&fit=crop&fp-x=0.5&fp-y=0.5&w=430","srcSet":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.06&fit=crop&fp-x=0.5&fp-y=0.5&w=430 25w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.12&fit=crop&fp-x=0.5&fp-y=0.5&w=430 50w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.24&fit=crop&fp-x=0.5&fp-y=0.5&w=430 100w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.47&fit=crop&fp-x=0.5&fp-y=0.5&w=430 200w","sizes":"(min-width: 100px) 100px, 100vw"}},"layout":"constrained","placeholder":{"fallback":"data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHBwgHBhINEBAQCggUDg0IDgcHFh0JFhEYFxUZGCIVFhUaHysjGh0oHRUWJDUlKC0vMjIyGSI4PTcwPCsxMi8BCgsLDg0OEg4REC8dFhwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL//AABEIABgAGAMBIgACEQEDEQH/xAAaAAEBAAIDAAAAAAAAAAAAAAAABAUGAQID/8QAHRAAAgICAwEAAAAAAAAAAAAAAAIDBAEREhQVBf/EABYBAQEBAAAAAAAAAAAAAAAAAAADAf/EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/ANASs2WLoaraMl1o0O241wSYlSHjgHM9hVAEFr6bKSemzAAeclpnAAH/2Q=="},"width":100,"height":100}},"author":{"authorName":"손승열(Son Seungyeol)","picture":{"authorImageData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.39&w=77","srcSet":"https://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.11&w=77 8w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.2&w=77 15w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.39&w=77 30w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.78&w=77 60w","sizes":"(min-width: 30px) 30px, 100vw"}},"layout":"constrained","width":30,"height":30}}},"subtitle":"효율적이고 유연하게 메모리를 가상화하는 방법에 대해 공부해봅니다.","title":"[운영체제][OSTEP] 주소 변환의 원리"}],"structuredBody":{"blocks":[],"links":[],"value":{"schema":"dast","document":{"type":"root","children":[{"type":"heading","level":2,"children":[{"type":"span","value":"1️⃣ 메모리 공간의 종류"}]},{"type":"paragraph","children":[{"type":"span","value":"C 프로그램이 실행되면, 두 가지 유형의 메모리 공간이 할당된다."}]},{"type":"heading","level":3,"children":[{"type":"span","marks":["highlight"],"value":"스택(stack) 메모리"}]},{"type":"paragraph","children":[{"type":"span","value":"할당과 반환은 프로그래머를 위해 "},{"type":"span","marks":["highlight"],"value":"컴파일러"},{"type":"span","value":"에 의해 "},{"type":"span","marks":["emphasis"],"value":"암묵적으로"},{"type":"span","value":" 이루어진다.\n➡️ 이러한 이유로 "},{"type":"span","marks":["highlight"],"value":"자동(automatic)"},{"type":"span","value":" 메모리라고도 불림."}]},{"type":"paragraph","children":[{"type":"span","value":"C 프로그램에서 스택에 메모리를 선언하기 위해서는 다음과 같은 식으로 코드를 작성하면 된다."}]},{"code":"void func() {\n  int x; // 스택에 int 형을 선언\n  ...\n}","type":"code","language":"c"},{"type":"paragraph","children":[{"type":"span","value":"위는 func( )라는 함수 안에서 정수를 저장할 변수 x를 위한 공간이 필요한 경우이다."}]},{"type":"paragraph","children":[{"type":"span","value":"이 경우 컴파일러가 나머지 작업을 수행하여, "},{"type":"span","marks":["highlight"],"value":"func( )가 호출될 때 스택에 공간을 확보"},{"type":"span","value":"한다."}]},{"type":"paragraph","children":[{"type":"span","marks":["highlight"],"value":"함수에서 리턴하면 컴파일러는 프로그래머 대신 메모리를 반환"},{"type":"span","value":"한다.\n➡️ 함수 리턴 이후에도 유지되어야 하는 정보는 스택에 저장하지 않는 것이 바람직"}]},{"type":"heading","level":3,"children":[{"type":"span","marks":["highlight"],"value":"힙(heap) 메모리"}]},{"type":"paragraph","children":[{"type":"span","value":"모든 할당과 반환이 "},{"type":"span","marks":["highlight"],"value":"프로그래머"},{"type":"span","value":"에 의해 명시적으로 처리된다."}]},{"type":"paragraph","children":[{"type":"span","value":"이로 인해 프로그래머는 메모리 사용에 대한 책임을 져야하고 또한 이는 많은 버그의 원인이 되기도 한다. 🐞"}]},{"type":"paragraph","children":[{"type":"span","value":"C 프로그램에서 힙에 메모리를 할당하기 위해서는 다음과 같은 식으로 코드를 작성하면 된다."}]},{"code":"void func() {\n  int *x = (int *) malloc(sizeof(int));\n  ...\n}","type":"code","language":"c"},{"type":"paragraph","children":[{"type":"span","value":"위는 정수에 대한 포인터 변수 x를 위한 공간을 힙에 할당하는 경우이다."}]},{"type":"paragraph","children":[{"type":"span","value":"⚠️ 위 코드에서의 주의 사항을 살펴보자."}]},{"type":"paragraph","children":[{"type":"span","value":"1️⃣ 한 행에 "},{"type":"span","marks":["highlight"],"value":"스택과 힙 할당이 모두 발생"},{"type":"span","value":"한다.\n➡️ 포인터 변수 "},{"type":"span","marks":["code"],"value":"int *x"},{"type":"span","value":" 선언 시 정수 포인터를 위한 공간을 스택에 할당한다.\n➡️ 프로그램이 "},{"type":"span","marks":["code"],"value":"malloc()"},{"type":"span","value":"을 호출하여 정수를 위한 공간을 힙으로부터 요구한다."}]},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"malloc()"},{"type":"span","value":"은 "},{"type":"span","marks":["highlight"],"value":"성공한 경우 그 정수가 저장된 메모리 주소를 반환"},{"type":"span","value":"하고, "},{"type":"span","marks":["highlight"],"value":"실패한 경우에는 "},{"type":"span","marks":["code","highlight"],"value":"NULL"},{"type":"span","marks":["highlight"],"value":"을 반환"},{"type":"span","value":"한다.\n➡️ 이 반환된 주소는 스택에 저장되어 프로그램에 의해 사용된다."}]},{"type":"paragraph","children":[{"type":"span","value":"이러한 명시적 성질과 다양한 쓰임새로 인해 힙 메모리의 사용한 사용자 & 시스템 모두에게 어려운 숙제"}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"2️⃣ malloc( ) 함수"}]},{"type":"paragraph","children":[{"type":"span","value":"힙에 요청할 공간의 크기를 넘겨 주었을 때, \n[✅ 성공 시] "},{"type":"span","marks":["highlight"],"value":"새로 할당된 공간에 대한 포인터를 사용자에게 반환"},{"type":"span","value":"\n[🚫 실패 시] "},{"type":"span","marks":["code","highlight"],"value":"NULL"},{"type":"span","marks":["highlight"],"value":"을 반환"}]},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"malloc()"},{"type":"span","value":"을 사용하기 위해서는 "},{"type":"span","marks":["code"],"value":"stdlib.h"},{"type":"span","value":"를 소스 코드에 포함시켜야 한다.\n➡️ 모든 C 프로그램에 디폴트로 링크되는 C 라이브러리는 "},{"type":"span","marks":["code"],"value":"malloc()"},{"type":"span","value":" 함수를 가지고 있으므로 포함시키지 않아도 됨.\n➡️ 헤더 파일 추가 시 "},{"type":"span","marks":["code"],"value":"malloc()"},{"type":"span","value":"을 올바르게 호출했는지 컴파일러가 검사할 수 있음."}]},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"malloc()"},{"type":"span","value":"의 인자는 "},{"type":"span","marks":["code"],"value":"size_t"},{"type":"span","value":" 타입(필요 공간의 크기를 바이트 단위로 표시)의 변수"}]},{"type":"paragraph","children":[{"type":"span","value":"예를 들어, "},{"type":"span","marks":["code"],"value":"double"},{"type":"span","value":" 부동 소수점 값을 위한 공간을 확보하기 위해서는 다음과 같이 코드를 작성할 수 있음."}]},{"code":"double *d = (double *) malloc(sizeof(double));","type":"code","language":"c"},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"sizeof()"},{"type":"span","value":"는 "},{"type":"span","marks":["underline"],"value":"컴파일 시간 연산자(함수X)"},{"type":"span","value":"로 할당하려는 공간의 크기가 컴파일 시간에 결정된다."}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"3️⃣ free( ) 함수"}]},{"type":"paragraph","children":[{"type":"span","marks":["highlight"],"value":"더 이상 사용되지 않는 힙 메모리를 해제하기 위해 호출한다."}]},{"type":"paragraph","children":[{"type":"span","value":"인자로는 "},{"type":"span","marks":["code"],"value":"malloc()"},{"type":"span","value":"에 의해 반환된 포인터 하나를 받는다."}]},{"type":"paragraph","children":[{"type":"span","value":"예를 들어, "},{"type":"span","marks":["code"],"value":"int"},{"type":"span","value":" 변수를 위한 공간을 할당한 후 메모리를 해제하는 경우 다음과 같이 코드를 작성할 수 있다."}]},{"code":"int *x = malloc(10 * sizeof(int));\n...\nfree(x);","type":"code","language":"c"},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"4️⃣ 흔한 오류"}]},{"type":"paragraph","children":[{"type":"span","value":"많은 새로운 언어들이 "},{"type":"span","marks":["highlight"],"value":"자동 메모리 관리(automatic memory management)"},{"type":"span","value":"를 지원함.\n➡️ "},{"type":"span","marks":["highlight"],"value":"쓰레기 수집기(garbage collector)"},{"type":"span","value":": 참조되지 않는 메모리가 알아서 해제"}]},{"type":"heading","level":3,"children":[{"type":"span","value":"메모리 할당 잊어버리기"}]},{"type":"paragraph","children":[{"type":"span","value":"많은 루팅은 자신이 호출되기 전 필요한 메모리가 미리 할당되었다고 가정 ex) "},{"type":"span","marks":["code"],"value":"strcpy()"},{"type":"span","value":"\n➡️ "},{"type":"span","marks":["highlight"],"value":"세그멘테이션 폴트(segmentation fault)"},{"type":"span","value":"가 발생할 수 있으므로 사용 전 메모리를 반드시 할당받자."}]},{"type":"heading","level":3,"children":[{"type":"span","value":"메모리를 부족하게 할당받기"}]},{"type":"paragraph","children":[{"type":"span","value":"때때로 "},{"type":"span","marks":["highlight"],"value":"버퍼 오버플로우(buffer \boverflow)"},{"type":"span","value":"라고 불림.\n잘 실행되는 듯 보일 수 있으나, 특정 시점에 보안 취약점의 원인이 될 수 있다.\n➡️ 프로그램이 한 번 올바르게 실행된다고 하더라도, 프로그램이 올바르다는 것은 아님."}]},{"type":"heading","level":3,"children":[{"type":"span","value":"할당받은 메모리 초기화하지 않기"}]},{"type":"paragraph","children":[{"type":"span","marks":["highlight"],"value":"초기화되지 않은 읽기(uninitialized read)"},{"type":"span","value":": 힙으로부터 알 수 없는 값을 읽음.\n➡️ 임의의 값 혹은 해로운 값이 읽힐 수 있으므로 메모리를 할당 받은 후 초기화를 하자."}]},{"type":"heading","level":3,"children":[{"type":"span","value":"메모리 해제하지 않기"}]},{"type":"paragraph","children":[{"type":"span","marks":["highlight"],"value":"메모리 누수(memory leak)"},{"type":"span","value":": 메모리 해제를 잊었을 때 발생함."}]},{"type":"paragraph","children":[{"type":"span","value":"장시간 실행되는 응용 프로그램이나 운영체제 자체와 같은 시스템 프로그램에서 큰 문제\n➡️ 결국 메모리 부족으로 시스템을 재시작해야 함."}]},{"type":"paragraph","children":[{"type":"span","value":"메모리 청크의 사용이 끝나면 반드시 해제\n➡️ 쓰레기 수집 기능이 있어도 메모리 청크에 대한 참조가 존재하면, 어느 쓰레기 수집기도 그 청크를 해제하지 않음."}]},{"type":"paragraph","children":[{"type":"span","value":"💡 "},{"type":"span","marks":["highlight"],"value":"프로세스가 종료하면 왜 메모리 누수가 일어나지 않는가?"}]},{"type":"paragraph","children":[{"type":"span","value":"시스템이 실제 두 단계로 메모리를 관리하기 때문이다."}]},{"type":"paragraph","children":[{"type":"span","value":"[첫 번째 단계] 운영체제에 의해 수행\n프로세스가 실행할 때 메모리를 프로세스에게 건네 주고 프로세스가 종료하거나 다른 이유로 죽을 때 메모리를 되돌려 받음."}]},{"type":"paragraph","children":[{"type":"span","value":"[두 번째 단계] 각 프로세스의 힙 내에서 수행("},{"type":"span","marks":["code"],"value":"malloc()"},{"type":"span","value":"과 "},{"type":"span","marks":["code"],"value":"free()"},{"type":"span","value":" 호출 시 등)"}]},{"type":"paragraph","children":[{"type":"span","value":"따라서 "},{"type":"span","marks":["code"],"value":"free()"},{"type":"span","value":"를 호출하지 못했더라도 "},{"type":"span","marks":["highlight"],"value":"프로세스 종료 시 운영체제가 프로세스의 모든 메모리(프로세스의 코드, 스택, 힙 등 모든 페이지)를 회수한다.\n"},{"type":"span","value":"➡️ 실행이 시간이 짧은 프로그램의 경우, 큰 문제가 발생하지 않음.\n➡️ Web 서버나 DBMS와 같이 "},{"type":"span","marks":["underline"],"value":"장시간 실행되는 경우 심각한 문제"},{"type":"span","value":"가 될 수 있음.\n➡️ 특히 운영체제 자신(커널 코드)에서 메모리 누"}]},{"type":"heading","level":3,"children":[{"type":"span","value":"메모리 사용이 끝나기 전에 메모리 해제하기"}]},{"type":"paragraph","children":[{"type":"span","value":"해제된 메모리를 가리키는 "},{"type":"span","marks":["highlight"],"value":"dangling pointer"},{"type":"span","value":" 문제가 발생할 수 있다.\n➡️ 프로그램을 크래시시키거나 유효 메모리 영역을 덮어쓸 수 있음."}]},{"type":"heading","level":3,"children":[{"type":"span","value":"반복적으로 메모리 해제하기"}]},{"type":"paragraph","children":[{"type":"span","value":"프로그램은 가끔씩 메모리를 한 번 이상 해제하며 "},{"type":"span","marks":["highlight"],"value":"이중 해제(double free)"},{"type":"span","value":"라 불림.\n➡️ 결과는 예측하기 어려움. 가장 흔하게는 크래시가 일어남."}]},{"type":"heading","level":3,"children":[{"type":"span","value":"free( ) 잘못 호출하기"}]},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"free()"},{"type":"span","value":"는 "},{"type":"span","marks":["code"],"value":"malloc()"},{"type":"span","value":"받은 포인터만 전달될 것으로 예상\n➡️ 그 이외의 값을 전달하면 "},{"type":"span","marks":["highlight"],"value":"유효하지 않은 해제(invalid frees)"},{"type":"span","value":" 문제가 발생한다."}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"5️⃣ 운영체제의 지원"}]},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"malloc()"},{"type":"span","value":"과 "},{"type":"span","marks":["code"],"value":"free()"},{"type":"span","value":"는 시스템 콜이 아닌 "},{"type":"span","marks":["highlight"],"value":"라이브러리 함수"},{"type":"span","value":"이다!"}]},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"malloc"},{"type":"span","value":" 라이브러리가 프로세스 가상 주소 공간 안의 공간을 관리하지만 "},{"type":"span","marks":["highlight"],"value":"라이브러리 자체는 시스템에게 더 많은 메모리를 요구하고 반환하는 시스템 콜을 기반으로 구축"},{"type":"span","value":"됨."}]},{"type":"paragraph","children":[{"type":"span","value":"그런 시스템 콜 중 하나가 "},{"type":"span","marks":["code","highlight"],"value":"brk"},{"type":"span","marks":["highlight"],"value":" 시스템 콜"},{"type":"span","value":": 프로그램의 break 위치를 변경하는 데 사용됨.\n🔖 break는 힙의 마지막 위치를 나타냄."}]},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"brk"},{"type":"span","value":"는 새로운 break 주소를 나타내는 한 개의 인자를 받음.\n➡️ 새로운 break가 현재 break보다 큰지 작은지에 따라 힙의 크기를 증가시키거나 감소시킴."}]},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"sbrk"},{"type":"span","value":"는 인자로 increment를 더 받는 것을 제외하고 비슷한 용도로 사용됨."}]},{"type":"paragraph","children":[{"type":"span","value":"⚠️ "},{"type":"span","marks":["code"],"value":"brk"},{"type":"span","value":" 또는 "},{"type":"span","marks":["code"],"value":"sbrk"},{"type":"span","value":"를 직접 호출해서는 안 됨. ➡️ "},{"type":"span","marks":["code"],"value":"malloc()"},{"type":"span","value":"과 "},{"type":"span","marks":["code"],"value":"free()"},{"type":"span","value":" 사용"}]},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"mmap()"},{"type":"span","value":" 함수를 사용하여 "},{"type":"span","marks":["highlight"],"value":"운영체제로부터 메모리를 얻을 수도 있음."}]},{"type":"paragraph","children":[{"type":"span","value":"올바른 인자를 전달하면 mmap()은 프로그램에 anonymous의 메모리 영역을 만듦.\n🔖 anonymous 영역은 특정 파일과 연결되어 있지 않고 "},{"type":"span","marks":["highlight"],"value":"스왑 공간(swap space)"},{"type":"span","value":"에 연결된 영역을 말함. ➡️ 힙 처럼 취급되고 관리됨."}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"6️⃣ 기타 함수들"}]},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"calloc()"},{"type":"span","value":"은 할당 영역을 0으로 채워서 메모리를 반환\n➡️ "},{"type":"span","marks":["highlight"],"value":"초기화되지 않은 읽기 문제 방지"}]},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"realloc()"},{"type":"span","value":"은 더 큰 새로운 영역을 확보하고 옛 영역의 내용을 복사한 후에 새 영역에 대한 포인터를 반환\n➡️ "},{"type":"span","marks":["highlight"],"value":"이미 할당된 공간(배열 등)에 대해 추가의 공간이 필요할 때 유용"},{"type":"span","value":"\n"}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"📚 참고 문헌"}]},{"type":"paragraph","children":[{"url":"https://pages.cs.wisc.edu/~remzi/OSTEP/vm-api.pdf","meta":[{"id":"target","value":"_blank"}],"type":"link","children":[{"type":"span","value":"Operating Systems: Three Easy Pieces ― 14: Interlude: Memory API"}]}]},{"type":"paragraph","children":[{"url":"https://pages.cs.wisc.edu/~remzi/OSTEP/Korean/14-vm-api.pdf","meta":[{"id":"target","value":"_blank"}],"type":"link","children":[{"type":"span","value":"운영체제 아주 쉬운 세 가지 이야기 ― 17: 막간 : 메모리 관리 API"}]}]}]}}}}},"pageContext":{"id":"145790692","locale":"ko-KR"}},"staticQueryHashes":["1034768456","1118752904","2342916782","2757196681","3415878905","3879866231","4195094990"]}