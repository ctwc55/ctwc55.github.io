{"componentChunkName":"component---src-templates-article-jsx","path":"/blog/development/os-ffs","result":{"data":{"datoCmsMiscTextString":{"locale":"ko-KR","updatedAtText":"업데이트됨","nextReadText":"관련있는 게시물"},"datoCmsBlogPost":{"locale":"ko-KR","originalId":"WuCVn1aqRbKXwn4qw1wTjQ","title":"[운영체제][OSTEP] 지역성과 Fast File System","seo":{"seoTitle":"[운영체제][OSTEP] 지역성과 Fast File System","seoDescription":"성능 개선을 위해 디스크 특성을 파일 시스템에 반영한 FFS에 대해 공부해봅니다.","seoImage":{"seoImageUrl":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format"}},"subtitle":"성능 개선을 위해 디스크 특성을 파일 시스템에 반영한 FFS에 대해 공부해봅니다.","coverImage":{"coverImageData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&w=860","srcSet":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.25&w=860 215w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.5&w=860 430w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&w=860 860w","sizes":"(min-width: 860px) 860px, 100vw"}},"layout":"constrained","placeholder":{"fallback":"data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHBwgHBgoICAgLCgoLDhMVDhcNDh0VDxUSGhYdHSIVFhUaKysjGh0oHSEWJDUlKC0vMjIyGSI4PTcwPCsxMi8BCgsLCgUFEBAOEC8oIhwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL//AABEIAAwAGAMBIgACEQEDEQH/xAAYAAEAAwEAAAAAAAAAAAAAAAAFAQQGAP/EAB0QAAEEAgMAAAAAAAAAAAAAAAEAAgMEESEFEjL/xAAWAQADAAAAAAAAAAAAAAAAAAAAAQP/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDD1KM1uPLjpIRUI4GZc4aRXH25hTOHqqbth7yDIVIiXI2IQzqCoREhL/RyuQH/2Q=="},"width":860,"height":430}},"meta":{"updatedAt":"2023-10-30T17:30:22.597+09:00","firstPublishedAt":"2023-10-30T03:31:18.338+09:00"},"categoryLink":{"title":"개발 공부","id":"4743072"},"author":{"authorName":"손승열(Son Seungyeol)","picture":{"authorPictureData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.78&w=77","srcSet":"https://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.2&w=77 15w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.39&w=77 30w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.78&w=77 60w","sizes":"(min-width: 60px) 60px, 100vw"}},"layout":"constrained","placeholder":{"fallback":"data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHBwgHBgoICAgWEQ8LDhgYDhUNDhgNDw8NFxUdGBYfFhUaHysjGikoHRUWJDUlKC0vMjIyGSI4PTcwPCsxMi8BCgsLDg0OHBANHDUcIig7NS81NS81MjUvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL//AABEIABgAFAMBIgACEQEDEQH/xAAYAAEAAwEAAAAAAAAAAAAAAAAABQYHAv/EAB4QAAICAgMBAQAAAAAAAAAAAAABAgMFBgQRQXEi/8QAFQEBAQAAAAAAAAAAAAAAAAAABAP/xAAaEQACAwEBAAAAAAAAAAAAAAAAAQIDEhMR/9oADAMBAAIRAxEAPwDT8/1LHSK/r67scevSfz99VXBkm/Cva/zKle/pCc/JoRXWsFujxvygcLI1pAXqQTmjONm2RzpceyCwmwxpsbbADWJdBFbeCfe2wXoAGpIL6z//2Q=="},"width":60,"height":60}}},"relatedPosts":[{"id":"unin-rusT1GyZmZqNl0Ogg","meta":{"updatedAt":"2023-10-30T03:32:10.341+09:00"},"categoryLink":{"title":"개발 공부"},"coverImage":{"gatsbyImageData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.35&w=860","srcSet":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.09&w=860 75w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.18&w=860 150w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.35&w=860 300w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.7&w=860 600w","sizes":"(min-width: 300px) 300px, 100vw"}},"layout":"constrained","width":300,"height":120},"squaredImage":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.24&fit=crop&fp-x=0.5&fp-y=0.5&w=430","srcSet":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.06&fit=crop&fp-x=0.5&fp-y=0.5&w=430 25w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.12&fit=crop&fp-x=0.5&fp-y=0.5&w=430 50w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.24&fit=crop&fp-x=0.5&fp-y=0.5&w=430 100w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.47&fit=crop&fp-x=0.5&fp-y=0.5&w=430 200w","sizes":"(min-width: 100px) 100px, 100vw"}},"layout":"constrained","placeholder":{"fallback":"data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHBwgHBhINEBAQCggUDg0IDgcHFh0JFhEYFxUZGCIVFhUaHysjGh0oHRUWJDUlKC0vMjIyGSI4PTcwPCsxMi8BCgsLDg0OEg4REC8dFhwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL//AABEIABgAGAMBIgACEQEDEQH/xAAaAAEBAAIDAAAAAAAAAAAAAAAABAUGAQID/8QAHRAAAgICAwEAAAAAAAAAAAAAAAIDBAEREhQVBf/EABYBAQEBAAAAAAAAAAAAAAAAAAADAf/EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/ANASs2WLoaraMl1o0O241wSYlSHjgHM9hVAEFr6bKSemzAAeclpnAAH/2Q=="},"width":100,"height":100}},"author":{"authorName":"손승열(Son Seungyeol)","picture":{"authorImageData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.39&w=77","srcSet":"https://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.11&w=77 8w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.2&w=77 15w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.39&w=77 30w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.78&w=77 60w","sizes":"(min-width: 30px) 30px, 100vw"}},"layout":"constrained","width":30,"height":30}}},"subtitle":"간단한 파일 시스템을 만드는 방법에 대해 공부합니다.","title":"[운영체제][OSTEP] 파일 시스템 구현"}],"structuredBody":{"blocks":[{"__typename":"DatoCmsArticleBodyImage","id":"Vp_cGXYWT6mDnSFpZa7IbA","image":{"gatsbyImageData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1698645706-2023-10-30-3-00-07.png?auto=format&w=860","srcSet":"https://www.datocms-assets.com/66479/1698645706-2023-10-30-3-00-07.png?auto=format&dpr=0.25&w=860 215w,\nhttps://www.datocms-assets.com/66479/1698645706-2023-10-30-3-00-07.png?auto=format&dpr=0.5&w=860 430w,\nhttps://www.datocms-assets.com/66479/1698645706-2023-10-30-3-00-07.png?auto=format&w=860 860w","sizes":"(min-width: 860px) 860px, 100vw"}},"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAANCAIAAAA4++m6AAAAAXNSR0IArs4c6QAAAfdJREFUOE99U8tu4zAMJCnJjpPYmxcKtGk/IP//QwHSQ4ukTmA7dlKJ4h7oVVssUF4sG+ZwODNCEQEAAAghdF3nnIsxGmOISA/OOSKCn8WREZCIRAQR03dUuBhj13UikjoR8Xq9tl2bZ3lRFDFGRMzzfDKZ3G43ItJJ1lpFUNARznv/+vr69PSU57mIvL+/Xy6XYRiUpg4QEe89Ijrnnp+fZ7MZAPgQpkWR2NnExXt/PB632+3lctnv96fTiZl3u50xxhgjIiJyPB4Ph0NZlmVZWmtns9n5fK4/Ph4eHrIs+4IjojzPich7z8x933vv+74/nU5pHWNMXdfe+2EYdN/Pz0/vfdM0q9XqB1zf97fbzTmHiIioCzJz2zRIREQiEQD7vk8yWWuHYbjf70SU3Bh1qet6GAZVJ3lNRGSMoiPqmwEAdTOEwMwAEGNMLSO7LMuKokBEbUgUvruWzoiYMsDMxo4gkNit12sypGnQijEyszKKMQKAiqiMdIAq7qxNy47AxhhrrPbHGEMIzrnlcrndbo0xSkdz9/b2pqRCCFVVhRCapklhGh/MfL/f1f6qql5eXhaLxXw+Z+aki16SsiwfHx83m810OlUTNK36z1eM27ZdrVbwr9q2bZrmer0KjHAg4Jwrq+pPVWksVE/8/5L9Xt8N+b3+Avs8OQg40lOPAAAAAElFTkSuQmCC"},"width":860,"height":430},"alt":"cylinder group"}},{"__typename":"DatoCmsArticleBodyImage","id":"9HEm2VJMRa2AzCoCHca4pA","image":{"gatsbyImageData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1698652112-2023-10-30-4-47-31.png?auto=format&w=860","srcSet":"https://www.datocms-assets.com/66479/1698652112-2023-10-30-4-47-31.png?auto=format&dpr=0.25&w=860 215w,\nhttps://www.datocms-assets.com/66479/1698652112-2023-10-30-4-47-31.png?auto=format&dpr=0.5&w=860 430w,\nhttps://www.datocms-assets.com/66479/1698652112-2023-10-30-4-47-31.png?auto=format&w=860 860w","sizes":"(min-width: 860px) 860px, 100vw"}},"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAANCAIAAAA4++m6AAAAAXNSR0IArs4c6QAAAR1JREFUOE+FUkGOxCAMcxJC6Wj+/9VSIMkekKrVlnZ9AoSNHUMRgRt67733z+czt8dxuHvOWVVba2amqimlO3FxBICZmfk4jlqrqn6/X7PR+2itRQQzE9GSuJaLCDNjZhFx99YaACJSVVV90sKTnIgwc0pp3/fe+3QEYBnwN/h+NO2YGYCIiAjNCmAqLmd9YfFaa22MkXOeTBFx88vgS1Is3c2kZhYR7j4N/htzYiGnqqUUAER0dTLXAAJvYRdymM26AyCilNLvmIS3sI//LonUWkVk2zZ3mwVcPYjIcoiPE5m+ImKM4e5mJiLEPMvetk1EAvHHLL0XP9FaO89z30tK+n5zLRcRtVYQ2RjneeacmSiAAMK9lJJzvrMA/AALTLWQYvFWmAAAAABJRU5ErkJggg=="},"width":860,"height":430},"alt":"ffs locality for seer traces"}}],"links":[],"value":{"schema":"dast","document":{"type":"root","children":[{"type":"heading","level":2,"children":[{"type":"span","value":"🚪 들어가며"}]},{"type":"paragraph","children":[{"type":"span","value":"Unix의 창시자 Ken Thompson이 개발한 첫 번째 파일 시스템은 정말 단순해서 \"오래된 Unix 파일 시스템\"이라 불림."}]},{"type":"paragraph","children":[{"type":"span","value":"디스크 상의 구조는 다음과 같음."}]},{"code":"┌───┬────────┬──────────────────────────────┐\n│ S │ Inodes │              Data            │\n└───┴────────┴──────────────────────────────┘","type":"code"},{"type":"list","style":"bulleted","children":[{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"슈퍼블럭(S): 볼륨 크기, 아이노드 개수, 프리 블럭 리스트의 헤드를 가리키는 포인터 등이 존재"}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"아이노드 영역: 모든 아이노드들이 존재"}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"데이터 영역"}]}]}]},{"type":"paragraph","children":[{"type":"span","value":"✅ 장점은 단순하다는 것\n➡️  파일 시스템의 가장 기본적인 개념인 파일과 디렉터리만을 제공"}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"1️⃣ 문제: 낮은 성능"}]},{"type":"paragraph","children":[{"type":"span","value":"⚠️ 문제는 성능이 매우 안좋다는 것\n➡️ 디스크를 마치 RAM처럼 사용함.\n➡️ 여기저기에 데이터를 저장하여 디스크 헤드를 이동시키는 데 많은 시간이 소요됨."}]},{"type":"paragraph","children":[{"type":"span","value":"예를 들어 아이노드를 읽은 후 해당 데이터 블럭을 읽는 매우 흔한 작업의 경우\n➡️ 파일의 데이터 블럭이 대체적으로 아이노드에서 멀리 떨어져 있기 때문에 디스크 헤드 이동에 많은 시간을 소요하게 됨."}]},{"type":"paragraph","children":[{"type":"span","value":"⚠️ 심지어 파일 시스템이 빈 공간을 효율적으로 관리하지 않기 때문에 결국 "},{"type":"span","marks":["highlight"],"value":"단편화(fragment)"},{"type":"span","value":" 문제도 발생\n➡️ 🚫 성능이 심각하게 나빠짐."}]},{"type":"paragraph","children":[{"type":"span","value":"각 2개의 블럭의 크기를 갖는 네 개의 파일(A, B, C, D) 중 B와 D를 삭제한 후 4개의 블럭으로 구성된 파일 E를 할당하는 경우를 가정해보자."}]},{"code":"[1] 파일 A, B, C, D 존재\n┌────┬────┬────┬────┬────┬────┬────┬────┐\n│ A1 │ A2 │ B1 │ B2 │ C1 │ C2 │ D1 │ D2 │\n└────┴────┴────┴────┴────┴────┴────┴────┘\n\n[2] 파일 B, D 삭제\n┌────┬────┬────┬────┬────┬────┬────┬────┐\n│ A1 │ A2 │    │    │ C1 │ C2 │    │    │\n└────┴────┴────┴────┴────┴────┴────┴────┘\n\n[3] 파일 E 할당\n┌────┬────┬────┬────┬────┬────┬────┬────┐\n│ A1 │ A2 │ E1 │ E2 │ C1 │ C2 │ E3 │ E4 │\n└────┴────┴────┴────┴────┴────┴────┴────┘","type":"code"},{"type":"paragraph","children":[{"type":"span","value":"이와 같이 E를 이루는 블럭들이 디스크 상에서 흩어져 있게 됨.\n➡️ E를 읽거나 쓸 경우, 디스크로부터 최대(순차) 성능을 얻을 수 없음.\n➡️ ✅ 조각 모음 도구를 통해 이 문제를 해결해볼 수 있음."}]},{"type":"paragraph","children":[{"type":"span","value":"⚠️ 또 다른 문제는 블럭의 크기(512 바이트)가 너무 작다는 것\n➡️ 입출력 단위가 너무 작기 때문에 디스크로부터 데이터를 전송하는 것은 원천적으로 매우 비효율적"}]},{"type":"paragraph","children":[{"type":"span","value":"✅ 작은 크기의 블럭은 "},{"type":"span","marks":["highlight"],"value":"내부 단편화(internal fragmentation)"},{"type":"span","value":"가 작은 장점이 있음."}]},{"type":"paragraph","children":[{"type":"span","value":"⚠️ 그러나, 디스크 헤드의 이동시간에 비해 데이터 블럭의 크기가 작아 입출력이 상대적으로 비효율적"}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"2️⃣ FFS: 디스크에 대한 이해가 해답이다"}]},{"type":"paragraph","children":[{"type":"span","value":"Berkeley의 한 그룹이 더 낫고 빠른 파일 시스템을 만들기로 결정하고 "},{"type":"span","marks":["highlight"],"value":"Fast File System, FFS"},{"type":"span","value":"라고 명명함."}]},{"type":"paragraph","children":[{"type":"span","value":"💡 파일 시스템의 자료 구조와 할당 정책을 \"디스크에 적합\"하게 설계하여 성능을 개선하는 것이 핵심"}]},{"type":"paragraph","children":[{"type":"span","value":"✅ 파일 시스템 인터페이스("},{"type":"span","marks":["code"],"value":"open()"},{"type":"span","value":", "},{"type":"span","marks":["code"],"value":"read()"},{"type":"span","value":", "},{"type":"span","marks":["code"],"value":"write()"},{"type":"span","value":", "},{"type":"span","marks":["code"],"value":"close()"},{"type":"span","value":" 등의 파일 시스템 콜)는 그대로 유지하면서  내부 구현 방식을 변경함."}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"3️⃣ 파일 시스템 구조: 실린더 그룹"}]},{"type":"paragraph","children":[{"type":"span","value":"첫 번째 단계는 디스크에 적합하게 파일 시스템 구성을 수정하는 것이었음."}]},{"type":"paragraph","children":[{"type":"span","value":"💡 FFS는 디스크를 여러 개의 "},{"type":"span","marks":["highlight"],"value":"실린더 그룹"},{"type":"span","value":"("},{"type":"span","marks":["highlight"],"value":"cylinder group"},{"type":"span","value":", 현대 Linux의 ext2, ext3에서는 "},{"type":"span","marks":["highlight"],"value":"블럭 그룹(block group)"},{"type":"span","value":"으로 부르기도 함)으로 분할함."}]},{"item":"Vp_cGXYWT6mDnSFpZa7IbA","type":"block"},{"type":"list","style":"bulleted","children":[{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"하나의 실린더는 위의 그림에서 같은 색의 원들이 모여서 구성"}]},{"type":"paragraph","children":[{"type":"span","value":"➡️ 드라이브 중심에서 같은 거리만큼 떨어진 각 표면의 트랙들의 집합"}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"FFS는 N개의 연속된 실린더를 모아서 하나의 그룹으로 만듦."}]},{"type":"paragraph","children":[{"type":"span","value":"➡️ 전체 디스크가 실린더 그룹의 모임으로 보여질 수 있음."}]},{"type":"paragraph","children":[{"type":"span","value":"➡️ 위의 그림에서 3개의 실린더가 모여서 하나의 실린더 그룹을 형성함.(N = 3)"}]}]}]},{"type":"paragraph","children":[{"type":"span","value":"💡 메모리 가상화에서 그랬듯, 최신 드라이브는 특정 실린더가 사용 중인지 파일 시스템이 제대로 파악할 만큼 충분한 정보를 내보내지 않고 "},{"type":"span","marks":["highlight"],"value":"블록으로 구성된 논리 주소 공간을 내보내고 클라이언트로부터 형상의 세부 정보를 숨김.\n"},{"type":"span","value":"➡️ 따라서 현대식 파일 시스템(예: Linux ext2, ext3, ext4)은 대신 드라이브를 블록 그룹으로 구성하고 각 블록은 디스크 주소 공간의 연속적인 배열에 불과함."}]},{"type":"paragraph","children":[{"type":"span","value":"실린더 그룹이 열 개 있는 디스크를 다음과 같이 생각해볼 수 있음."}]},{"code":"┌────┬────┬────┬────┬────┬────┬────┬────┬────┬────┐\n│ G0 │ G1 │ G2 │ G3 │ G4 │ G5 │ G6 │ G7 │ G8 │ G9 │\n└────┴────┴────┴────┴────┴────┴────┴────┴────┴────┘","type":"code"},{"type":"paragraph","children":[{"type":"span","value":"🛸 실린더 그룹은 FFS의 핵심 중의 핵심\n➡️ "},{"type":"span","marks":["highlight"],"value":"두 개의 파일을 같은 그룹에 배치"},{"type":"span","value":"시켜서 한 파일을 읽고 다음 파일을 접근할 때 "},{"type":"span","marks":["highlight"],"value":"디스크 전역에 걸친 긴 탐색이 발생하지 않도록 함."}]},{"type":"paragraph","children":[{"type":"span","value":"💡 FFS는 파일과 그 파일이 속한 디렉터리 블럭을 같은 그룹에 할당함.\n➡️ 그룹이 꽉 차면 밀려나는 경우가 발생할 수 있음."}]},{"type":"paragraph","children":[{"type":"span","value":"각 그룹은 다음과 같이 구성됨."}]},{"code":"┌───┬────┬────┬────────┬──────────────────────────────┐\n│ S │ ib │ db │ Inodes │              Data            │\n└───┴────┴────┴────────┴──────────────────────────────┘","type":"code"},{"type":"list","style":"bulleted","children":[{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","marks":["highlight"],"value":"슈퍼블럭"},{"type":"span","value":"의 복사본(S)이 각 그룹마다 존재"}]},{"type":"paragraph","children":[{"type":"span","value":"➡️ 하나가 훼손되더라도 다른 것을 사용하여 파일 시스템을 마운트하고 접근할 수 있음."}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"그룹 별로 "},{"type":"span","marks":["highlight"],"value":"아이노드 비트맵"},{"type":"span","value":"(ib)과 "},{"type":"span","marks":["highlight"],"value":"데이터 비트맵"},{"type":"span","value":"(db)이 존재"}]},{"type":"paragraph","children":[{"type":"span","value":"➡️ 각 그룹의 아이노드와 데이터 블럭의 할당 정보를 나타냄."}]},{"type":"paragraph","children":[{"type":"span","value":"➡️ 비트맵은 파일 시스템의 빈 영역을 나타내는 훌륭한 방법임."}]},{"type":"paragraph","children":[{"type":"span","value":"➡️ 큰 크기의 연속된 빈 공간을 쉽게 찾을 수 있음."}]},{"type":"paragraph","children":[{"type":"span","value":"➡️ 프리 시스트 사용 시 발생하는 파일 시스템의 단편화 문제도 어느 정도 피할 수 있음."}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"아이노드와 데이터 블럭 영역은 위의 아주 단순한 파일 시스템에서 봤던 것과 동일"}]},{"type":"paragraph","children":[{"type":"span","value":"➡️ 각 실린더 그룹의 대부분도 마찬가지로 데이터 블럭들로 이루어져 있음."}]}]}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"4️⃣ 파일과 디렉터리 할당 정책"}]},{"type":"paragraph","children":[{"type":"span","value":"성능 개선을 위해 파일과 디렉터리 및 관련된 메타데이터를 디스크에 어떻게 배치해야할지를 결정해야 함.\n➡️ 💡 기본 원칙은 \"관련있는 것끼리 모으는\" 것"}]},{"type":"paragraph","children":[{"type":"span","value":"이를 위해서는 우선 무엇이 \"관련있는\" 지 파악하여 그것들을 같은 블럭 그룹 내에 저장함.\n➡️ 반대로 관련없는 항목들은 서로 다른 블럭 그룹에 저장"}]},{"type":"paragraph","children":[{"type":"span","value":"💡 이를 달성하기 위해 FFS는 몇 가지 힌트를 사용함."}]},{"type":"paragraph","children":[{"type":"span","value":"첫 번째는 디렉터리의 위치 결정에 관한 것"}]},{"type":"list","style":"bulleted","children":[{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"할당된 디렉터리의 수가 적고(그룹들 간에 디렉터리에 대한 균형을 맞추기 위해) 프리 아이노드의 수가 많은 실린더 그룹을 선택하여 디렉터리 데이터와 아이노드를 해당 그룹에 저장"}]},{"type":"paragraph","children":[{"type":"span","value":"➡️ 프리 데이터 블럭의 수를 고려하는 등 다른 방법을 따를 수도 있음."}]}]}]},{"type":"paragraph","children":[{"type":"span","value":"파일의 경우 FFS는 두 가지 방법을 사용함."}]},{"type":"list","style":"bulleted","children":[{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"(일반적인 경우에) 아이노드와 파일의 데이터 블럭을 같은 그룹에 할당하여 아이노드와 데이터 간의 긴 탐색을 방지"}]},{"type":"paragraph","children":[{"type":"span","value":"➡️ 오래된 파일 시스템과 같은 방식"}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"동일한 디렉터리 내의 모든 파일들은 해당 디렉터리가 존재하는 실린더 그룹에 함께 저장"}]}]}]},{"type":"paragraph","children":[{"type":"span","value":"⚠️ 이러한 방식은 상식(common sense)에 기반한 것\n➡️ 파일 시스템 사용에 관한 완벽한 분석이나 그와 유사한 무엇을 통해 나온 것이 아님."}]},{"type":"paragraph","children":[{"type":"span","value":"디렉터리 내의 파일들은 대체적으로 같이 접근이 됨.\n➡️ ✅ 관련 파일들 간의 탐색이 짧아지기 때문에 FFS는 성능을 개선할 수 있음."}]},{"type":"paragraph","children":[{"type":"span","value":"\r"}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"5️⃣ 파일 접근의 지역성 측정"}]},{"type":"paragraph","children":[{"type":"span","value":"이러한 경험적 상식에 근거한 접근이 정당한지를 알기 위해 namespace 지역성이 실제 존재하는지 알아보자."}]},{"type":"paragraph","children":[{"type":"span","value":"SEER 트레이스를 사용하여 디렉터리 트리 내에서 파일 간의 접근이 얼마나 \"멀리 떨어져\" 있는 지를 분석함.\n➡️ 거리 기준 = 두 파일의 조상 경로명이 동일하게 될 때까지 디렉터리 트리를 얼마나 타고 올라가야 하는지"}]},{"type":"paragraph","children":[{"type":"span","value":"예를 들어 다음과 같음."}]},{"type":"list","style":"bulleted","children":[{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"파일 open 간의 거리 0"}]},{"type":"list","style":"bulleted","children":[{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"파일 "},{"type":"span","marks":["code"],"value":"f"},{"type":"span","value":"가 열린 후 다른 파일이 열리기 전에 다시 그 파일이 열린 경우"}]}]}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"파일 open 간의 거리 1"}]},{"type":"list","style":"bulleted","children":[{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"파일 "},{"type":"span","marks":["code"],"value":"/dir/f"},{"type":"span","value":"가 열린 후 다른 파일이 열리기 전에 파일 "},{"type":"span","marks":["code"],"value":"/dir/g"},{"type":"span","value":"가 열린 경우"}]}]}]}]}]},{"type":"paragraph","children":[{"type":"span","value":"즉, 트리 상에서 가까이 있을수록 낮은 값을 갖게 됨."}]},{"type":"paragraph","children":[{"type":"span","value":"다음은 SEER 클러스터에 속해 있는 여러 워크스테이션들의 전체 트레이스를 합하여 지역성을 나타낸 것\n➡️ 경로 간의 거리를 x축에, 이에 대한 누적 빈도를 y축에 표현"}]},{"item":"9HEm2VJMRa2AzCoCHca4pA","type":"block"},{"type":"paragraph","children":[{"type":"span","value":"\"Trace\"는 일반적인 경우, \"Random\"은 비교를 위한 파일 임의 접근 트레이스임."}]},{"type":"paragraph","children":[{"type":"span","value":"먼저 Trace의 결과를 살펴보자."}]},{"type":"list","style":"bulleted","children":[{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"약 7%가 직전에 열었던 파일을 다시 열었음."}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"거의 40%의 경우가 같은 디렉터리 내의 파일 또는 같은 파일을 열었음."}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"25% 정도는 경로가 2만큼 떨어져 있음."}]},{"type":"paragraph","children":[{"type":"span","value":"➡️ 이 현상은 사용자가 서로 관련된 디렉터리들을 묶어두고 이들 디렉터리에 존재하는 파일들을 번갈아 접근할 때 발생하는 것으로 판명됨."}]}]}]},{"type":"paragraph","children":[{"type":"span","value":"Random 트레이스의 경우 이름 공간의 지역성이 낮은 것을 볼 수 있음.\n➡️ 하지만 결국 모든 파일은 루트와 같은 동일한 조상을 갖기 때문에 약간의 지역성은 보임."}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"6️⃣ 대용량 파일 예외 상황"}]},{"type":"paragraph","children":[{"type":"span","value":"파일 배치 시 예외 상황이 있음.\n➡️ 파일 크기가 매우 큰 경우"}]},{"type":"paragraph","children":[{"type":"span","value":"⚠️ 별도의 규칙을 적용하지 않으면 하나의 파일이 블럭 그룹(과 다른 블럭들)을 모두 채울 수 있음.\n➡️ 이는 그 뒤의 \"관련\"있는 파일들을 다른 블럭 그룹에 저장되도록 만들어 파일 접근 지역성을 떨어뜨리게 됨."}]},{"type":"paragraph","children":[{"type":"span","value":"FFS는 큰 파일들의 배치를 다음과 같이 처리함."}]},{"type":"list","style":"numbered","children":[{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"첫 번째 블럭 그룹에 일정 수의 블럭을 할당"}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"파일의 \"큰\" 청크를 다른 블럭 그룹(사용률이 낮은 것으로 선택)에 저장"}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"파일의 다음 청크는 마찬가지로 또 다른 블럭 그룹에 저장"}]}]}]},{"type":"paragraph","children":[{"type":"span","value":"다음 예시를 통해 이를 조금 더 이해해보자."}]},{"type":"paragraph","children":[{"type":"span","value":"만약 큰 파일에 대한 예외 처리 없이 저장한다면 다음과 같이 될 것임."}]},{"code":"G0    G1    G2    G3    G4    G5    G6    G7    G8    G9\n      ┌─────┴─────┐\n      │ 0 1 2 3 4 │\n      │ 5 6 7 8 9 │\n      └───────────┘","type":"code"},{"type":"paragraph","children":[{"type":"span","value":"큰 파일에 대한 예외 처리를 한다면 다음과 같이 파일은 디스크 전반에 걸쳐 청크 단위로 저장될 것임."}]},{"code":"G0    G1    G2    G3    G4    G5    G6    G7    G8    G9\n┌┴──┐     ┌─┴─┐       ┌─┴─┐       ┌─┴─┐       ┌─┴─┐\n│8 9│     │0 1│       │2 3│       │4 5│       │6 7│\n└───┘     └───┘       └───┘       └───┘       └───┘","type":"code"},{"type":"paragraph","children":[{"type":"span","value":""}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"7️⃣"}]},{"type":"paragraph","children":[{"type":"span","value":""}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"📚 참고 문헌"}]},{"type":"paragraph","children":[{"url":"https://pages.cs.wisc.edu/~remzi/OSTEP/file-ffs.pdf","meta":[{"id":"target","value":"_blank"}],"type":"link","children":[{"type":"span","value":"Operating Systems: Three Easy Pieces ― 41: Locality and The Fast File System"}]}]},{"type":"paragraph","children":[{"url":"https://pages.cs.wisc.edu/~remzi/OSTEP/Korean/41_FFS.pdf","meta":[{"id":"target","value":"_blank"}],"type":"link","children":[{"type":"span","value":"운영체제 아주 쉬운 세 가지 이야기 ― 44: 지역성과 Fast File System"}]}]}]}}}}},"pageContext":{"id":"WuCVn1aqRbKXwn4qw1wTjQ","locale":"ko-KR"}},"staticQueryHashes":["1034768456","1118752904","2342916782","2757196681","3415878905","3879866231","4195094990"]}