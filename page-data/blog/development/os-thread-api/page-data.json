{"componentChunkName":"component---src-templates-article-jsx","path":"/blog/development/os-thread-api","result":{"data":{"datoCmsMiscTextString":{"locale":"ko-KR","updatedAtText":"업데이트됨","nextReadText":"관련있는 게시물"},"datoCmsBlogPost":{"locale":"ko-KR","originalId":"187067258","title":"[운영체제][OSTEP] 쓰레드 API","seo":{"seoTitle":"[운영체제][OSTEP] 쓰레드 API","seoDescription":"쓰레드 API를 이용하여 쓰레드를 생성하고 제어하는 방법에 대해 공부해봅니다","seoImage":{"seoImageUrl":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format"}},"subtitle":"쓰레드 API를 이용하여 쓰레드를 생성하고 제어하는 방법에 대해 공부해봅니다","coverImage":{"coverImageData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&w=860","srcSet":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.25&w=860 215w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.5&w=860 430w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&w=860 860w","sizes":"(min-width: 860px) 860px, 100vw"}},"layout":"constrained","placeholder":{"fallback":"data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHBwgHBgoICAgLCgoLDhMVDhcNDh0VDxUSGhYdHSIVFhUaKysjGh0oHSEWJDUlKC0vMjIyGSI4PTcwPCsxMi8BCgsLCgUFEBAOEC8oIhwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL//AABEIAAwAGAMBIgACEQEDEQH/xAAYAAEAAwEAAAAAAAAAAAAAAAAFAQQGAP/EAB0QAAEEAgMAAAAAAAAAAAAAAAEAAgMEESEFEjL/xAAWAQADAAAAAAAAAAAAAAAAAAAAAQP/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDD1KM1uPLjpIRUI4GZc4aRXH25hTOHqqbth7yDIVIiXI2IQzqCoREhL/RyuQH/2Q=="},"width":860,"height":430}},"meta":{"updatedAt":"2023-08-16T17:09:18.861+09:00","firstPublishedAt":"2023-08-15T21:31:54.745+09:00"},"categoryLink":{"title":"개발 공부","id":"4743072"},"author":{"authorName":"손승열(Son Seungyeol)","picture":{"authorPictureData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.78&w=77","srcSet":"https://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.2&w=77 15w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.39&w=77 30w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.78&w=77 60w","sizes":"(min-width: 60px) 60px, 100vw"}},"layout":"constrained","placeholder":{"fallback":"data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHBwgHBgoICAgWEQ8LDhgYDhUNDhgNDw8NFxUdGBYfFhUaHysjGikoHRUWJDUlKC0vMjIyGSI4PTcwPCsxMi8BCgsLDg0OHBANHDUcIig7NS81NS81MjUvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL//AABEIABgAFAMBIgACEQEDEQH/xAAYAAEAAwEAAAAAAAAAAAAAAAAABQYHAv/EAB4QAAICAgMBAQAAAAAAAAAAAAABAgMFBgQRQXEi/8QAFQEBAQAAAAAAAAAAAAAAAAAABAP/xAAaEQACAwEBAAAAAAAAAAAAAAAAAQIDEhMR/9oADAMBAAIRAxEAPwDT8/1LHSK/r67scevSfz99VXBkm/Cva/zKle/pCc/JoRXWsFujxvygcLI1pAXqQTmjONm2RzpceyCwmwxpsbbADWJdBFbeCfe2wXoAGpIL6z//2Q=="},"width":60,"height":60}}},"relatedPosts":[{"id":"186104748","meta":{"updatedAt":"2023-08-15T22:03:04.145+09:00"},"categoryLink":{"title":"개발 공부"},"coverImage":{"gatsbyImageData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.35&w=860","srcSet":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.09&w=860 75w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.18&w=860 150w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.35&w=860 300w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.7&w=860 600w","sizes":"(min-width: 300px) 300px, 100vw"}},"layout":"constrained","width":300,"height":120},"squaredImage":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.24&fit=crop&fp-x=0.5&fp-y=0.5&w=430","srcSet":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.06&fit=crop&fp-x=0.5&fp-y=0.5&w=430 25w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.12&fit=crop&fp-x=0.5&fp-y=0.5&w=430 50w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.24&fit=crop&fp-x=0.5&fp-y=0.5&w=430 100w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.47&fit=crop&fp-x=0.5&fp-y=0.5&w=430 200w","sizes":"(min-width: 100px) 100px, 100vw"}},"layout":"constrained","placeholder":{"fallback":"data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHBwgHBhINEBAQCggUDg0IDgcHFh0JFhEYFxUZGCIVFhUaHysjGh0oHRUWJDUlKC0vMjIyGSI4PTcwPCsxMi8BCgsLDg0OEg4REC8dFhwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL//AABEIABgAGAMBIgACEQEDEQH/xAAaAAEBAAIDAAAAAAAAAAAAAAAABAUGAQID/8QAHRAAAgICAwEAAAAAAAAAAAAAAAIDBAEREhQVBf/EABYBAQEBAAAAAAAAAAAAAAAAAAADAf/EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/ANASs2WLoaraMl1o0O241wSYlSHjgHM9hVAEFr6bKSemzAAeclpnAAH/2Q=="},"width":100,"height":100}},"author":{"authorName":"손승열(Son Seungyeol)","picture":{"authorImageData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.39&w=77","srcSet":"https://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.11&w=77 8w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.2&w=77 15w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.39&w=77 30w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.78&w=77 60w","sizes":"(min-width: 30px) 30px, 100vw"}},"layout":"constrained","width":30,"height":30}}},"subtitle":"병행성과 쓰레드에 대해 공부해봅니다.","title":"[운영체제][OSTEP] 병행성과 쓰레드"}],"structuredBody":{"blocks":[],"links":[],"value":{"schema":"dast","document":{"type":"root","children":[{"type":"heading","level":2,"children":[{"type":"span","value":"1️⃣ 쓰레드 생성"}]},{"type":"paragraph","children":[{"type":"span","value":"멀티 쓰레드 프로그램 작성 시, 가정 먼저할 일은 새로운 쓰레드의 생성이다."}]},{"type":"paragraph","children":[{"type":"span","value":"쓰레드 생성을 위해서는 해당 인터페이스가 존재해야 한다. "},{"url":"https://ko.wikipedia.org/wiki/POSIX","meta":[{"id":"target","value":"_blank"}],"type":"link","children":[{"type":"span","value":"POSIX"}]},{"type":"span","value":"에서는 다음과 같다."}]},{"code":"#include <pthread.h>\n\nint pthread_create(       pthread_t *      thread,\n                    const pthread_attr_t * attr,\n                          void *           (*start_routine)(void*),\n                          void *           arg);\r","type":"code","language":"c"},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"thread"},{"type":"span","value":", "},{"type":"span","marks":["code"],"value":"attr"},{"type":"span","value":", "},{"type":"span","marks":["code"],"value":"start_routine"},{"type":"span","value":", "},{"type":"span","marks":["code"],"value":"arg"},{"type":"span","value":"라는 4개의 인자가 있다. 이를 하나씩 살펴보자."}]},{"type":"heading","level":3,"children":[{"type":"span","value":"첫 번째 인자: thread"}]},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"pthread_t"},{"type":"span","value":" 타입 구조체를 가리키는 포인터로, 이 구조가 "},{"type":"span","marks":["highlight"],"value":"쓰레드와 상호작용하는 데 사용"},{"type":"span","value":"되므로 쓰레드 초기화 시 "},{"type":"span","marks":["code"],"value":"pthread_create()"},{"type":"span","value":"에 이 구조체를 전달한다."}]},{"type":"heading","level":3,"children":[{"type":"span","value":"두 번째 인자: attr"}]},{"type":"paragraph","children":[{"type":"span","value":"쓰레드의 속성을 지정하는 데 사용하며, "},{"type":"span","marks":["highlight"],"value":"스택의 크기와 쓰레드의 스케줄링 우선순위 같은 정보를 지정"},{"type":"span","value":"하기 위해서 사용될 수 있다."}]},{"type":"paragraph","children":[{"type":"span","value":"개별 속성은 "},{"type":"span","marks":["code"],"value":"pthread_attr_init()"},{"type":"span","value":" 함수를 호출하여 초기화한다."}]},{"type":"paragraph","children":[{"type":"span","marks":["highlight"],"value":"대부분의 경우에 디폴트 값"},{"type":"span","value":"(간단히 "},{"type":"span","marks":["code"],"value":"NULL"},{"type":"span","value":")을 지정하면 충분하다."}]},{"type":"heading","level":3,"children":[{"type":"span","value":"세 번째 인자: (*start_routine)(void*)"}]},{"type":"paragraph","children":[{"type":"span","value":"이 쓰레드가 "},{"type":"span","marks":["highlight"],"value":"실행할 함수(함수 포인터)"},{"type":"span","value":"를 나타낸다."}]},{"type":"paragraph","children":[{"type":"span","value":"이때 전달하는 함수는 "},{"type":"span","marks":["code"],"value":"void *"},{"type":"span","value":"타입의 인자 한개를 전달받고, "},{"type":"span","marks":["code"],"value":"void *"},{"type":"span","value":"타입의 값을 반환한다."}]},{"type":"paragraph","children":[{"type":"span","value":"void 포인터 타입 대신 "},{"type":"span","marks":["code"],"value":"integer"},{"type":"span","value":"를 인자로 사용하는 루틴인 경우"}]},{"code":"int pthread_create(.... // 처음 두 인자는 동일함\n                    void * (*start_routine)(int),\n                    void * arg);","type":"code","language":"c"},{"type":"paragraph","children":[{"type":"span","value":"void 포인터 타입을 인자로 받지만, "},{"type":"span","marks":["code"],"value":"interger"},{"type":"span","value":" 타입을 반환하는 경우"}]},{"code":"int pthread_create(.... // 처음 두 인자는 동일함\n                    int    (*start_routine)(void*),\n                    void * arg);","type":"code","language":"c"},{"type":"heading","level":3,"children":[{"type":"span","value":"네 번째 인자: arg"}]},{"type":"paragraph","children":[{"type":"span","marks":["highlight"],"value":"실행할 함수에게 전달할 인자"},{"type":"span","value":"를 나타낸다."}]},{"type":"paragraph","children":[{"type":"span","value":"void 포인터 타입이 필요한 이유\n➡️ 어떤 데이터 타입도 인자로 전달할 수 있음.\n➡️ 반환 값의 타입으로 사용하면 쓰레드는 어떤 타입의 결과도 반환 가능"}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"2️⃣ 쓰레드 종료"}]},{"type":"paragraph","children":[{"type":"span","value":"다른 쓰레드의 작업 완료를 기다려야 하는 경우\n➡️ POSIX 쓰레드에서는 "},{"type":"span","marks":["code"],"value":"pthread_join()"},{"type":"span","value":"을 호출"}]},{"code":"int pthread_join(pthread_t thread, void **value_ptr);","type":"code","language":"c"},{"type":"paragraph","children":[{"type":"span","value":"이 루틴은 "},{"type":"span","marks":["code"],"value":"thread"},{"type":"span","value":", "},{"type":"span","marks":["code"],"value":"**value_ptr"},{"type":"span","value":" 두 개의 인자를 받는다. 이를 하나씩 살펴보자."}]},{"type":"heading","level":3,"children":[{"type":"span","value":"첫 번째 인자: thread"}]},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"pthread_t"},{"type":"span","value":" 타입의 인자로, "},{"type":"span","marks":["highlight"],"value":"어떤 쓰레드를 기다려야 하는지 명시"},{"type":"span","value":"한다.\n➡️ 해당 변수는 쓰레드 생성 루틴("},{"type":"span","marks":["code"],"value":"pthread_create()"},{"type":"span","value":")에 의해 초기화된다."}]},{"type":"heading","level":3,"children":[{"type":"span","value":"두 번째 인자: **value_ptr"}]},{"type":"paragraph","children":[{"type":"span","marks":["highlight"],"value":"반환 값에 대한 포인터"},{"type":"span","value":"로, 루틴이 임의의 데이터 타입을 반환할 수 있으므로 void에 대한 포인터 타입으로 정의한다."}]},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"pthread_join()"},{"type":"span","value":" 루틴은 전달된 인자의 값을 변경하기 때문에 값에 대한 포인터를 전달해야 한다."}]},{"type":"heading","level":3,"children":[{"type":"span","value":"예시"}]},{"code":"#include <stdio.h>\n#include <pthread.h>\n#include <assert.h>\n#include <stdlib.h>\n\ntypedef struct __myarg_t {\n  int a;\n  int b;\n} myarg_t;\n\ntypedef struct __myret_t {\n  int x;\n  int y;\n} myret_t;\n\nvoid *mythread(void *arg) {\n  myarg_t *m = (myarg_t *) arg;\n  printf(\"%d %d\\n\", m−>a, m−>b);\n  myret_t *r = malloc(sizeof(myret_t));\n  r−>x = 1;\n  r−>y = 2;\n  return (void *) r;\n}\n\nint main(int argc, char *argv[]) \n{\n  int rc;\n  pthread_t p;\n  myret_t *m;\n  \n  myarg_t args;\n  args.a = 10;\n  args.b = 20;\n  Pthread_create(&p, NULL, mythread, &args);\n  Pthread_join(p, (void **) &m);\n  printf(\"returned %d %d\\n\", m−>x, m−>y);\n  return 0;\n}","type":"code","language":"c"},{"type":"paragraph","children":[{"type":"span","value":"위의 예시에서는 기존 루틴들의 예상치 못한 값의 반환을 방지하기 위해 래퍼 함수("},{"type":"span","marks":["code"],"value":"Pthread_create()"},{"type":"span","value":", "},{"type":"span","marks":["code"],"value":"Pthread_join()"},{"type":"span","value":")를 사용하고 있음에 유의하자."}]},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"mythread()"},{"type":"span","value":"는 반환 값으로 "},{"type":"span","marks":["code"],"value":"myret_t"},{"type":"span","value":" 타입을 사용하고 있는데, 쓰레드가 실행을 마치면 반환한 값을 "},{"type":"span","marks":["code"],"value":"pthread_join()"},{"type":"span","value":"함수에서 받아 접근할 수 있다."}]},{"type":"paragraph","children":[{"type":"span","value":"만약 인자가 없는 쓰레드를 생성할 때에서는 "},{"type":"span","marks":["code"],"value":"NULL"},{"type":"span","value":"을 전달하여 쓰레드를 생성할 수도 있고, 반환 값이 필요 없다면 "},{"type":"span","marks":["code"],"value":"pthread_join()"},{"type":"span","value":"에 "},{"type":"span","marks":["code"],"value":"NULL"},{"type":"span","value":"을 전달할 수도 있다."}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"3️⃣"}]},{"type":"paragraph","children":[{"type":"span","value":""}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"4️⃣"}]},{"type":"paragraph","children":[{"type":"span","value":""}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"5️⃣"}]},{"type":"paragraph","children":[{"type":"span","value":""}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"📚 참고 문헌"}]},{"type":"paragraph","children":[{"url":"https://pages.cs.wisc.edu/~remzi/OSTEP/threads-api.pdf","meta":[{"id":"target","value":"_blank"}],"type":"link","children":[{"type":"span","value":"Operating Systems: Three Easy Pieces ― 27: Interlude: Thread API"}]}]},{"type":"paragraph","children":[{"url":"https://pages.cs.wisc.edu/~remzi/OSTEP/Korean/27_threads-api.pdf","meta":[{"id":"target","value":"_blank"}],"type":"link","children":[{"type":"span","value":"운영체제 아주 쉬운 세 가지 이야기 ― 30: 막간 : 쓰레드 API"}]}]}]}}}}},"pageContext":{"id":"187067258","locale":"ko-KR"}},"staticQueryHashes":["1034768456","1118752904","2342916782","2757196681","3415878905","3879866231","4195094990"]}