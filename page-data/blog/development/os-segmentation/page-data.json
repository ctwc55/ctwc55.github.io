{"componentChunkName":"component---src-templates-article-jsx","path":"/blog/development/os-segmentation","result":{"data":{"datoCmsMiscTextString":{"locale":"ko-KR","updatedAtText":"업데이트됨","nextReadText":"관련있는 게시물"},"datoCmsBlogPost":{"locale":"ko-KR","originalId":"177405298","title":"[운영체제][OSTEP] 세그멘테이션","seo":{"seoTitle":"[운영체제][OSTEP] 세그멘테이션","seoDescription":"대용량 주소 공간을 지원하는 방법에 대해 공부해봅니다.","seoImage":{"seoImageUrl":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format"}},"subtitle":"대용량 주소 공간을 지원하는 방법에 대해 공부해봅니다.","coverImage":{"coverImageData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&w=860","srcSet":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.25&w=860 215w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.5&w=860 430w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&w=860 860w","sizes":"(min-width: 860px) 860px, 100vw"}},"layout":"constrained","placeholder":{"fallback":"data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHBwgHBgoICAgLCgoLDhMVDhcNDh0VDxUSGhYdHSIVFhUaKysjGh0oHSEWJDUlKC0vMjIyGSI4PTcwPCsxMi8BCgsLCgUFEBAOEC8oIhwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL//AABEIAAwAGAMBIgACEQEDEQH/xAAYAAEAAwEAAAAAAAAAAAAAAAAFAQQGAP/EAB0QAAEEAgMAAAAAAAAAAAAAAAEAAgMEESEFEjL/xAAWAQADAAAAAAAAAAAAAAAAAAAAAQP/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDD1KM1uPLjpIRUI4GZc4aRXH25hTOHqqbth7yDIVIiXI2IQzqCoREhL/RyuQH/2Q=="},"width":860,"height":430}},"meta":{"updatedAt":"2023-07-18T23:24:51.666+09:00","firstPublishedAt":"2023-07-18T15:58:56.254+09:00"},"categoryLink":{"title":"개발 공부","id":"4743072"},"author":{"authorName":"손승열(Son Seungyeol)","picture":{"authorPictureData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.78&w=77","srcSet":"https://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.2&w=77 15w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.39&w=77 30w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.78&w=77 60w","sizes":"(min-width: 60px) 60px, 100vw"}},"layout":"constrained","placeholder":{"fallback":"data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHBwgHBgoICAgWEQ8LDhgYDhUNDhgNDw8NFxUdGBYfFhUaHysjGikoHRUWJDUlKC0vMjIyGSI4PTcwPCsxMi8BCgsLDg0OHBANHDUcIig7NS81NS81MjUvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL//AABEIABgAFAMBIgACEQEDEQH/xAAYAAEAAwEAAAAAAAAAAAAAAAAABQYHAv/EAB4QAAICAgMBAQAAAAAAAAAAAAABAgMFBgQRQXEi/8QAFQEBAQAAAAAAAAAAAAAAAAAABAP/xAAaEQACAwEBAAAAAAAAAAAAAAAAAQIDEhMR/9oADAMBAAIRAxEAPwDT8/1LHSK/r67scevSfz99VXBkm/Cva/zKle/pCc/JoRXWsFujxvygcLI1pAXqQTmjONm2RzpceyCwmwxpsbbADWJdBFbeCfe2wXoAGpIL6z//2Q=="},"width":60,"height":60}}},"relatedPosts":[{"id":"176854321","meta":{"updatedAt":"2023-07-18T17:02:12.468+09:00"},"categoryLink":{"title":"개발 공부"},"coverImage":{"gatsbyImageData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.35&w=860","srcSet":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.09&w=860 75w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.18&w=860 150w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.35&w=860 300w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?auto=format&dpr=0.7&w=860 600w","sizes":"(min-width: 300px) 300px, 100vw"}},"layout":"constrained","width":300,"height":120},"squaredImage":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.24&fit=crop&fp-x=0.5&fp-y=0.5&w=430","srcSet":"https://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.06&fit=crop&fp-x=0.5&fp-y=0.5&w=430 25w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.12&fit=crop&fp-x=0.5&fp-y=0.5&w=430 50w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.24&fit=crop&fp-x=0.5&fp-y=0.5&w=430 100w,\nhttps://www.datocms-assets.com/66479/1686988115-ostep.jpg?ar=1&auto=format&crop=focalpoint&dpr=0.47&fit=crop&fp-x=0.5&fp-y=0.5&w=430 200w","sizes":"(min-width: 100px) 100px, 100vw"}},"layout":"constrained","placeholder":{"fallback":"data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHBwgHBhINEBAQCggUDg0IDgcHFh0JFhEYFxUZGCIVFhUaHysjGh0oHRUWJDUlKC0vMjIyGSI4PTcwPCsxMi8BCgsLDg0OEg4REC8dFhwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL//AABEIABgAGAMBIgACEQEDEQH/xAAaAAEBAAIDAAAAAAAAAAAAAAAABAUGAQID/8QAHRAAAgICAwEAAAAAAAAAAAAAAAIDBAEREhQVBf/EABYBAQEBAAAAAAAAAAAAAAAAAAADAf/EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/ANASs2WLoaraMl1o0O241wSYlSHjgHM9hVAEFr6bKSemzAAeclpnAAH/2Q=="},"width":100,"height":100}},"author":{"authorName":"손승열(Son Seungyeol)","picture":{"authorImageData":{"images":{"sources":[],"fallback":{"src":"https://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.39&w=77","srcSet":"https://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.11&w=77 8w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.2&w=77 15w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.39&w=77 30w,\nhttps://www.datocms-assets.com/66479/1649735652-kakaotalk_20220412_124457267.jpg?auto=format&dpr=0.78&w=77 60w","sizes":"(min-width: 30px) 30px, 100vw"}},"layout":"constrained","width":30,"height":30}}},"subtitle":"효율적이고 유연하게 메모리를 가상화하는 방법에 대해 공부해봅니다.","title":"[운영체제][OSTEP] 주소 변환의 원리"}],"structuredBody":{"blocks":[],"links":[],"value":{"schema":"dast","document":{"type":"root","children":[{"type":"heading","level":2,"children":[{"type":"span","value":"1️⃣ 세그멘테이션: 베이스/바운드(base/bound)의 일반화"}]},{"type":"paragraph","children":[{"type":"span","value":"💡아이디어\nMMU 안에 오직 하나의 베이스와 바운드 쌍만 존재하는 것이 아니라 주소 공간의 논리적인 "},{"type":"span","marks":["highlight"],"value":"세그멘트(segment)"},{"type":"span","value":"마다 베이스와 바운드 쌍이 존재"}]},{"type":"paragraph","children":[{"type":"span","value":"📏 세그멘트 = 특정 길이를 가지는 연속적인 주소 공간"}]},{"type":"paragraph","children":[{"type":"span","value":"코드, 스택, 힙 세 종류의 세그멘트\n➡️ "},{"type":"span","marks":["highlight"],"value":"세그멘테이션"},{"type":"span","value":"을 사용하면 운영체제는 "},{"type":"span","marks":["highlight"],"value":"각 세그멘트를 물리 메모리의 각기 다른 위치에 배치"},{"type":"span","value":"할 수 있음 + "},{"type":"span","marks":["highlight"],"value":"사용되지 않는 가상 주소 공간이 물리 메모리를 차지하는 것을 방지"}]},{"type":"paragraph","children":[{"type":"span","value":"다음의 예시와 함께 이를 살펴보자."}]},{"code":" 0 KB ┌──────────────────────┐\n      │                      │\n 1 KB │                      │\n      │     Program Code     │\n 2 KB ├──────────────────────┤\n      │                      │\n 3 KB │                      │\n      │                      │\n 4 KB ├──────────────────────┤\n      │                      │\n 5 KB │         Heap         │\n      │                      │\n 6 KB ├──────────────────────┤\n      │          │           │\n      │          │           │\n      │          │           │\n      │          ↓           │\n      │        (free)        │\n      │          ↑           │\n      │          │           │\n      │          │           │\n      │          │           │\n14 KB ├──────────────────────┤\n      │                      │\n15 KB │        Stack         │\n      │                      │\n16 KB └──────────────────────┘","type":"code"},{"type":"paragraph","children":[{"type":"span","value":"위의 주소 공간을 물리 메모리에 배치하려고 한다. "},{"type":"span","marks":["highlight"],"value":"각 세그멘트의 베이스와 바운드 쌍을 이용"},{"type":"span","value":"하여 세그멘트들을 다음과 같이 "},{"type":"span","marks":["highlight"],"value":"독립적으로 물리 메모리에 배치"},{"type":"span","value":"할 수 있다."}]},{"code":" 0 KB ┌──────────────────────┐\n      │                      │\n      │                      │\n      │   Operating System   │\n      │                      │\n      │                      │\n16 KB ├──────────────────────┤\n      │                      │\n      │     (not in use)     │\n      │          ↑           │\n      ├──────────────────────┤\n      │        Stack         │\n      ├──────────────────────┤\n      │     (not in use)     │\n32 KB ├──────────────────────┤\n      │         Code         │\n      ├──────────────────────┤\n      │         Heap         │\n      ├──────────────────────┤\n      │          ↓           │\n      │                      │\n48 KB │                      │\n      │                      │\n      │     (not in use)     │\n      │                      │\n      │                      │\n      │                      │\n64 KB └──────────────────────┘","type":"code"},{"type":"paragraph","children":[{"type":"span","value":"위의 예시에서 확인할 수 있듯이, 사용 중인 메모리에만 물리 공간이 할당된다.\n➡️ 사용되지 않은 영역이 많은 대형 주소 공간("},{"type":"span","marks":["highlight"],"value":"sparse address space"},{"type":"span","value":"라고도 부름)을 수용할 수 있다."}]},{"type":"paragraph","children":[{"type":"span","value":"위의 경우 3쌍의 베이스와 바운드 레지스터 집합이 필요하며 이는 세그멘트 레지스터에서 다음과 같이 나타낼 수 있다."}]},{"code":"Segment     Base     Size\n──────────────────────────\nCode        32K      2K\nHeap        34K      3K\nStack       28K      2K","type":"code"},{"type":"paragraph","children":[{"type":"span","value":"이때, "},{"type":"span","marks":["underline"],"value":"가상 주소 100번지를 참조"},{"type":"span","value":"한다고 가정해보자."}]},{"type":"paragraph","children":[{"type":"span","value":"첫 번째 그림에서 100번지는 코드 세그멘트에 속하므로 참조가 일어나면 하드웨어는 베이스 값(32KB)에 이 세그멘트의 오프셋(100)을 더해 물리 주소 32868(100+32KB)을 얻어낸다."}]},{"type":"paragraph","children":[{"type":"span","value":"그 후, 주소가 범위 내에 있는지 검사(100 < 2KB)하고, 범위 내에 있을 경우 물리 메모리 주소 32868을 읽는다."}]},{"type":"paragraph","children":[{"type":"span","marks":["underline"],"value":"가상 주소 4200번지를 참조"},{"type":"span","value":"하는 경우를 다시 가정해보자."}]},{"type":"paragraph","children":[{"type":"span","value":"4200번지는 힙 세그먼트에 속하므로 베이스 값(34KB)에 오프셋(4200-4096(힙은 가상 주소가 4KB에서 시작하므로!))을 더하여 34920(104+34KB)을 얻게 된다."}]},{"type":"paragraph","children":[{"type":"span","marks":["underline"],"value":"힙의 마지막을 벗어난 7KB와 같은 잘못된 주소를 접근"},{"type":"span","value":"하는 경우를 가정해보자."}]},{"type":"paragraph","children":[{"type":"span","value":"⛔ 하드웨어가 그 주소가 범위를 벗어났다는 것을 감지하고 운영체제에 트랩을 발생\n➡️ "},{"type":"span","marks":["highlight"],"value":"세그멘트 폴트(segment fault)"},{"type":"span","value":"가 발생"}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"2️⃣ 세그멘트 종류의 파악"}]},{"type":"paragraph","children":[{"type":"span","value":"하드웨어는 변환을 위해 "},{"type":"span","marks":["highlight"],"value":"세그멘트 레지스터"},{"type":"span","value":"를 사용"}]},{"type":"paragraph","children":[{"type":"span","value":"가상 주소가 참조하는 세그멘트와 세그멘트 내 오프셋의 크기를 알아내는 일반적인 접근법\n➡️ "},{"type":"span","marks":["highlight"],"value":"가상 주소의 최상위 몇 비트를 기준으로 주소 공간을 여러 세그멘트로 나누는 것\n"},{"type":"span","value":"➡️ VAX/VMS 시스템에서 사용된 기법"}]},{"type":"paragraph","children":[{"type":"span","value":"1️⃣의 예시에서는 3개의 세그멘트가 존재 ➡️ 주소 공간을 세그멘트로 나누기 위해 2비트가 필요"}]},{"type":"paragraph","children":[{"type":"span","value":"세그멘트 표시를 위해 가상 주소 14비트 중 최상위 2비트를 사용하는 경우 가상 주소의 모양은 다음과 같다."}]},{"code":" 13 12 11 10  9  8  7  6  5  4  3  2  1  0\n┌──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┐\n└──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┘\n└─────┴───────────────────────────────────┘\nSegment              Offset","type":"code"},{"type":"paragraph","children":[{"type":"span","value":"최상위 2비트의 세그멘트 표기는 다음과 같이 나타낼 수 있다."}]},{"type":"list","style":"bulleted","children":[{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"00: 코드 세그멘트"}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"01: 힙 세그멘트"}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"11: 스택 세그멘트"}]}]}]},{"type":"paragraph","children":[{"type":"span","value":"따라서 최상위 2비트의 "},{"type":"span","marks":["highlight"],"value":"세그멘트 표기를 통해 하드웨어는 그에 해당하는 베이스와 바운드를 사용"},{"type":"span","value":"할 수 있다."}]},{"type":"paragraph","children":[{"type":"span","value":"예를 들어, 위의 예시 중 "},{"type":"span","marks":["underline"],"value":"가상 주소 4200번지를 참조"},{"type":"span","value":"하는 경우 그에 해당하는 이진 형식은 다음과 같다."}]},{"code":"13 12 11 10  9  8  7  6  5  4  3  2  1  0\n┌────────────────────────────────────────┐\n 0  1  0  0  0  0  0  1  1  0  1  0  0  0\n└────────────────────────────────────────┘\n└────┴───────────────────────────────────┘\nSegment              Offset","type":"code"},{"type":"paragraph","children":[{"type":"span","value":"하드웨어는 최상위 2비트 01을 통해 힙 세그먼트를, 하위 12비트 0000 0110 1000을 통해 오프셋 104를 알아낼 수 있다."}]},{"type":"paragraph","children":[{"type":"span","marks":["highlight"],"value":"오프셋은 바운드 검사도 쉽게 만듦."},{"type":"span","value":"\n➡️ "},{"type":"span","marks":["underline"],"value":"오프셋이 바운드 보다 작은지 여부만 검사"},{"type":"span","value":"하면 됨."}]},{"type":"paragraph","children":[{"type":"span","value":"베이스와 바운드 쌍을 배열 형식으로 저장할 경우(세그멘트당 하나의 항목), 원하는 물리 주소를 얻기 위해 다음과 같은 작업을 수행"}]},{"code":"// 14 bit VA중의 상위 2 bit를 얻어옴\nSegment = (VirtualAddress & SEG_MASK) >> SEG_SHIFT\n// 이제 오프셋을 얻어옴\nOffset = VirtualAddress & OFFSET_MASK\nif (Offset >= Bounds[Segment])\n  RaiseException(PROTECTION_FAULT)\nelse\n  PhysAddr = Base[Segment] + Offset\n  Register = AccessMemory(PhysAddr)","type":"code"},{"type":"paragraph","children":[{"type":"span","value":"위의 예시를 기준으로 코드의 상수 값들을 다음과 같이 정할 수 있다."}]},{"type":"list","style":"bulleted","children":[{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"SEG_MASK"},{"type":"span","value":": 0x3000"}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"SEG_SHIFT"},{"type":"span","value":": 12"}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"OFFSET_MASK"},{"type":"span","value":": 0xFFF"}]}]}]},{"type":"paragraph","children":[{"type":"span","value":"주소 공간에는 세 개의 세그멘트(코드, 힙, 스택)만 존재하기 때문에 지정 가능한 세그멘트 하나는 미사용으로 남음. ➡️ 전체 주소 공간의 1/4은 사용이 불가능"}]},{"type":"paragraph","children":[{"type":"span","value":"이 문제의 해결을 위해 "},{"type":"span","marks":["underline"],"value":"일부 시스템은 코드와 힙을 하나의 세그멘트에 저장하고 세그멘트 선택을 위해 1비트만 사용"}]},{"type":"paragraph","children":[{"type":"span","value":"특정 주소의 세그멘트를 하드웨어적으로 파악하는 다른 방법 ➡️ "},{"type":"span","marks":["highlight"],"value":"묵시적(implicit)"},{"type":"span","value":" 접근 방식"}]},{"type":"paragraph","children":[{"type":"span","value":"묵시적 접근 방식에서는 "},{"type":"span","marks":["highlight"],"value":"주소가 어떻게 형성되었나를 관찰하여 세그멘트를 결정"}]},{"type":"paragraph","children":[{"type":"span","value":"주소가 프로그램 카운터에서 생성(명령어 반입): 주소는 코드 세그멘트 내에 있을 것임."}]},{"type":"paragraph","children":[{"type":"span","value":"주소가 스택 또는 베이스에 기반을 둠: 주소는 스택 세그멘트 내에 있음."}]},{"type":"paragraph","children":[{"type":"span","value":"다른 모든 주소: 힙 세그멘트 내에 있음."}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"3️⃣ 스택"}]},{"type":"paragraph","children":[{"type":"span","marks":["highlight"],"value":"다른 세그멘트들과는 반대 방향으로 확장\n"},{"type":"span","value":"➡️ 다른 방식의 변환이 필요"}]},{"type":"paragraph","children":[{"type":"span","value":"간단한 하드웨어가 추가로 필요\n➡️ 베이스와 바운드 값뿐 아니라 "},{"type":"span","marks":["highlight"],"value":"하드웨어는 세그멘트가 어느 방향으로 확장하는지도 알아야 함.\n"},{"type":"span","value":"ex) 하나의 비트를 사용하여 주소가 커지는 쪽으로 확장하면 1, 작아지는 쪽으로 확장하면 0으로 설정"}]},{"type":"paragraph","children":[{"type":"span","value":"이 사실을 반영하여 세그멘트 레지스터 상에서 하드웨어가 관리해야하는 정보를 다음과 같이 표현할 수 있다."}]},{"code":"Segment     Base     Size(max 4K)     Grows Positive?\n─────────────────────────────────────────────────────\nCode(00)    32K          2K                 1\nHeap(01)    34K          3K                 1\nStack(11)   28K          2K                 0","type":"code"},{"type":"paragraph","children":[{"type":"span","value":"예를 들어, 1️⃣의 예시 상황에서 "},{"type":"span","marks":["underline"],"value":"가상 주소 15KB에 접근"},{"type":"span","value":"한다고 가정해보자."}]},{"type":"paragraph","children":[{"type":"span","value":"이 주소는 물리 주소 27KB에 매핑 되어야 한다."}]},{"type":"paragraph","children":[{"type":"span","value":"이 가상 주소를 이진 형태로 바꾸면 다음과 같다."}]},{"code":"13 12 11 10  9  8  7  6  5  4  3  2  1  0\n┌────────────────────────────────────────┐\n 1  1  1  1  0  0  0  0  0  0  0  0  0  0\n└────────────────────────────────────────┘\n└────┴───────────────────────────────────┘\nSegment              Offset","type":"code"},{"type":"paragraph","children":[{"type":"span","value":"하드웨어는 최상위 2비트(11)을 사용하여 스택 세그먼트를 지정하고, 3KB의 오프셋이 남게 된다."}]},{"type":"paragraph","children":[{"type":"span","value":"올바른 음수 오프셋을 얻기 위해 3KB에서 최대 크기(4KB)를 뺀 -1KB를 얻는다."}]},{"type":"paragraph","children":[{"type":"span","value":"이 음수 오프셋을 베이스에 더하여 올바른 물리 주소 27KB(-1KB + 28KB)"}]},{"type":"paragraph","children":[{"type":"span","marks":["highlight"],"value":"바운드 검사는 음수 오프셋의 절댓값이 세그멘트의 크기보다 작다는 것을 확인하여 계산"},{"type":"span","value":"할 수 있음."}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"4️⃣ 공유 지원"}]},{"type":"paragraph","children":[{"type":"span","value":"메모리 절약을 위해 때로는 주소 공간들 간에 특정 메모리 세그멘트를 "},{"type":"span","marks":["highlight"],"value":"공유"},{"type":"span","value":"하는 것이 유용\n➡️ 특히, "},{"type":"span","marks":["highlight"],"value":"코드 공유"},{"type":"span","value":"가 일반적(현재 시스템에서도 광범위하게 사용 중)"}]},{"type":"paragraph","children":[{"type":"span","value":"공유 지원을 위해 하드웨어에 "},{"type":"span","marks":["highlight"],"value":"protection bit"},{"type":"span","value":"의 추가가 필요\n➡️ 세그멘트를 읽거나 쓸 수 있는지 혹은 세그멘트의 코드를 실행시킬 수 있는지를 나타냄."}]},{"type":"paragraph","children":[{"type":"span","marks":["highlight"],"value":"코드 세그멘트를 읽기 전용으로 설정"},{"type":"span","value":" ➡️ 주소 공간의 독립성을 유지하면서도, 여러 프로세스가 주소 공간의 일부를 공유할 수 있음."}]},{"type":"paragraph","children":[{"type":"span","value":"이를 반영하여 세그멘트 레지스터 값에 부가 정보를 추가하면 다음과 같이 나타낼 수 있다."}]},{"code":"Segment    Base  Size(max 4K)  Grows Positive?  Protection\n───────────────────────────────────────────────────────────\nCode(00)   32K       2K              1         Read-Execute\nHeap(01)   34K       3K              1         Read-Write\nStack(11)  28K       2K              0         Read-Write","type":"code"},{"type":"paragraph","children":[{"type":"span","value":"protection bit를 사용하면 앞의 하드웨어 알고리즘이 수정되어야 함.\n➡️ 가상 주소가 범위 내에 있는 지 확인 + "},{"type":"span","marks":["highlight"],"value":"특정 엑세스가 허용되는지 확인"}]},{"type":"paragraph","children":[{"type":"span","value":"사용자 프로세스가 "},{"type":"span","marks":["underline"],"value":"읽기 전용 페이지에 쓰기를 시도"},{"type":"span","value":"하는 경우 또는 "},{"type":"span","marks":["underline"],"value":"실행 불가 페이지에서 실행"},{"type":"span","value":"하려고 하는 경우\n➡️ "},{"type":"span","marks":["highlight"],"value":"하드웨어는 예외를 발생"},{"type":"span","value":"시켜 "},{"type":"span","marks":["highlight"],"value":"운영체제가 위반 프로세스를 처리"},{"type":"span","value":"할 수 있게 해야 함."}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"5️⃣ 소단위 대 대단위 세그멘테이션"}]},{"type":"paragraph","children":[{"type":"span","value":"지금까지 예제의 대부분은 소수의 세그멘트(코드, 스택, 힙)만들 지원하는 시스템에 주로 초점을 맞춤.\n➡️ 주소 공간을 비교적 큰 단위의 공간으로 분할하므로 이 세그멘테이션을 "},{"type":"span","marks":["highlight"],"value":"대단위(coarse-grained)"},{"type":"span","value":"라고 생각할 수 있음."}]},{"type":"paragraph","children":[{"type":"span","value":"일부 초기 시스템은 주소 공간을 작은 크기의 공간으로 잘게 나누는 것이 허용되었음.\n➡️ "},{"type":"span","marks":["highlight"],"value":"소단위(fine-grained)"},{"type":"span","value":" 세그멘테이션"}]},{"type":"paragraph","children":[{"type":"span","value":"많은 수의 세그멘트를 지원하기 위해서는 여러 세그멘트의 정보를 메모리에 저장할 수 있는 "},{"type":"span","marks":["highlight"],"value":"세그멘트 테이블"},{"type":"span","value":"과 같은 하드웨어가 필요\n➡️ 매우 많은 세그멘트를 손쉽게 생성하고 융통성 있게 세그멘트를 사용할 수 있음."}]},{"type":"paragraph","children":[{"type":"span","value":"💡 당시 소단위 세그멘테이션의 목표: 메인 메모리를 더 효율적으로 활용하자!"}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"6️⃣ 운영체제의 지원"}]},{"type":"paragraph","children":[{"type":"span","marks":["highlight"],"value":"세그멘테이션의 사용"},{"type":"span","value":" = 하나의 베이스-바운드 쌍을 사용하는 방식에 비해 "},{"type":"span","marks":["highlight"],"value":"물리 메모리를 엄청나게 절약"}]},{"type":"paragraph","children":[{"type":"span","value":"⚠️ 세그멘테이션은 새로운 많은 문제를 제기"}]},{"type":"paragraph","children":[{"type":"span","value":"["},{"type":"span","marks":["highlight"],"value":"1. 문맥 교환 시 운영체제는 어떤 일을 해야 하는가?"},{"type":"span","value":"]\n세그멘트 레지스터를 저장하고 복원해야 함."}]},{"type":"paragraph","children":[{"type":"span","value":"["},{"type":"span","marks":["highlight"],"value":"2. 미사용 중인 물리 메모리 공간의 관리"},{"type":"span","value":"]\n새로운 주소 공간이 생성 ➡️ 운영체제는 이 공간의 세그멘트를 위한 빈 물리 메모리 영역을 찾을 수 있어야 함.\n일반적으로 생길 수 있는 문제 ➡️ 물리 메모리가 빠르게 작은 크기의 빈 공간들로 채워짐.\n➡️ "},{"type":"span","marks":["highlight"],"value":"외부 단편화(external fragmentation)"}]},{"code":"          Not Compacted                       Compacted\n 0 KB ┌──────────────────────┐    0 KB ┌──────────────────────┐\n      │                      │         │                      │\n 8 KB │   Operating System   │    8 KB │   Operating System   │\n      │                      │         │                      │\n16 KB ├──────────────────────┤   16 KB ├──────────────────────┤\n      │     (not in use)     │         │                      │\n24 KB ├──────────────────────┤   24 KB │                      │\n      │      Allocated       │         │      Allocated       │\n32 KB ├──────────────────────┤   32 KB │                      │\n      │     (not in use)     │         │                      │\n      ├──────────────────────┤         │                      │\n40 KB │      Allocated       │   40 KB ├──────────────────────┤\n      ├──────────────────────┤         │                      │\n48 KB │                      │   48 KB │                      │\n      │     (not in use)     │         │     (not in use)     │\n56 KB ├──────────────────────┤   56 KB │                      │\n      │      Allocated       │         │                      │\n64 KB └──────────────────────┘   64 KB └──────────────────────┘","type":"code"},{"type":"paragraph","children":[{"type":"span","value":"이와 같은 문제의 해결책 중 하나로 위와 같이 기존의 세그멘트를 정리하여 물리 메모리를 "},{"type":"span","marks":["highlight"],"value":"압축(compact)"},{"type":"span","value":"하는 방법이 있다."}]},{"type":"paragraph","children":[{"type":"span","value":"위의 그림에서 왼쪽과 같이 압축이 되지 않은 상태에서는 20KB의 크기를 갖는 새로운 프로세스를 위한 공간을 할당할 수 없다."}]},{"type":"paragraph","children":[{"type":"span","value":"반면 운영체제가 현재 실행 중인 프로세스를 중단하고, 그들의 "},{"type":"span","marks":["highlight"],"value":"데이터를 하나의 연속된 공간에 복사"},{"type":"span","value":"하고, "},{"type":"span","marks":["highlight"],"value":"세그멘트 레지스터가 새로운 물리 메모리 위치를 가리키게"},{"type":"span","value":" 하여 "},{"type":"span","marks":["highlight"],"value":"작업을 위한 큰 빈 공간을 확보"},{"type":"span","value":"할 수 있다."}]},{"type":"paragraph","children":[{"type":"span","value":"⚠️ 하지만 세그먼트 복사는 메모리에 부하가 큰 연산 & 일반적으로 상당량의 프로세서 시간을 사용"}]},{"type":"paragraph","children":[{"type":"span","value":"💡 간단한 방법: "},{"type":"span","marks":["highlight"],"value":"빈 공간 리스트를 관리하는 알고리즘을 사용"}]},{"type":"list","style":"bulleted","children":[{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"최적 적합(best-fit)"}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"최악 적합(worst-fit)"}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"최초 적합(first-fit)"}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"버디 알고리즘(buddy algorithm)"}]}]}]},{"type":"paragraph","children":[{"type":"span","value":"등을 포함한 수백 개의 방식이 존재"}]},{"type":"paragraph","children":[{"type":"span","value":"알고리즘이 아무리 정교하게 동작한다고 해도 외부 단편화는 여전히 존재\n➡️ 좋은 알고리즘은 외부 단편화를 가능한 줄이는 것이 목표"}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"🧺 세그멘테이션 정리 하기"}]},{"type":"paragraph","children":[{"type":"span","value":"✅ "},{"type":"span","marks":["highlight"],"value":"메모리 가상화를 효과적으로 실현"},{"type":"span","value":"할 수 있음."}]},{"type":"paragraph","children":[{"type":"span","value":"✅ 단순한 동적 재배치를 넘어 주소 공간 상의 "},{"type":"span","marks":["highlight"],"value":"논리 세그멘트 사이의 큰 공간에 대한 낭비를 피함."},{"type":"span","value":"\n➡️ sparse address space를 지원"}]},{"type":"paragraph","children":[{"type":"span","value":"✅ 세그멘테이션에 필요한 산술 연산은 쉽고 하드웨어 구현에 적합 ➡️ "},{"type":"span","marks":["highlight"],"value":"속도가 빠름."}]},{"type":"paragraph","children":[{"type":"span","value":"✅ "},{"type":"span","marks":["highlight"],"value":"변환 오버헤드도 최소"},{"type":"span","value":"임."}]},{"type":"paragraph","children":[{"type":"span","value":"✅ "},{"type":"span","marks":["highlight"],"value":"코드 공유의 장점"},{"type":"span","value":"도 부가적으로 발생"}]},{"type":"paragraph","children":[{"type":"span","value":"⚠️ 세그멘트의 크기가 일정하지 않으므로 "},{"type":"span","marks":["highlight"],"value":"외부 단편화"},{"type":"span","value":" 문제 발생"}]},{"type":"paragraph","children":[{"type":"span","value":"⚠️ sparse address space를 지원할 만큼 충분히 유연하지 못함."}]},{"type":"thematicBreak"},{"type":"heading","level":2,"children":[{"type":"span","value":"📚 참고 문헌"}]},{"type":"paragraph","children":[{"url":"https://pages.cs.wisc.edu/~remzi/OSTEP/vm-segmentation.pdf","meta":[{"id":"target","value":"_blank"}],"type":"link","children":[{"type":"span","value":"Operating Systems: Three Easy Pieces ― 16: Segmentation"}]}]},{"type":"paragraph","children":[{"url":"https://pages.cs.wisc.edu/~remzi/OSTEP/Korean/16-vm-segmentation.pdf","meta":[{"id":"target","value":"_blank"}],"type":"link","children":[{"type":"span","value":"운영체제 아주 쉬운 세 가지 이야기 ― 19: 세그멘테이션"}]}]}]}}}}},"pageContext":{"id":"177405298","locale":"ko-KR"}},"staticQueryHashes":["1034768456","1118752904","2342916782","2757196681","3415878905","3879866231","4195094990"]}